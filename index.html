<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.8.dev">
<meta name="author" content="Servicio de las Tecnologías de la Información y las Comunicaciones - Universidad de Almería">
<title>Gestión de espacios. Desarrollo de una aplicación en Angular (Tutorial en curso)</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt,.quoteblock .quoteblock{margin:0 0 1.25em;padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="book toc2 toc-right">
<div id="header">
<h1>Gestión de espacios. Desarrollo de una aplicación en Angular (Tutorial en curso)</h1>
<div class="details">
<span id="author" class="author">Servicio de las Tecnologías de la Información y las Comunicaciones - Universidad de Almería</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Tabla de contenidos</div>
<ul class="sectlevel1">
<li><a href="#trueresumen">Resumen</a></li>
<li><a href="#trueintroducción">1. Introducción</a></li>
<li><a href="#truecreación-de-la-aplicación">2. Creación de la aplicación</a>
<ul class="sectlevel2">
<li><a href="#truecreación-de-la-aplicación-con-el-cli-de-angular">2.1. Creación de la aplicación con el CLI de Angular</a></li>
<li><a href="#trueinstalación-de-librerías">2.2. Instalación de librerías</a></li>
</ul>
</li>
<li><a href="#truecreación-del-scaffolding-de-la-aplicación">3. Creación del scaffolding de la aplicación</a>
<ul class="sectlevel2">
<li><a href="#truecreación-del-módulo-shared">3.1. Creación del módulo <code>shared</code></a></li>
<li><a href="#trueactualización-de-los-módulos-de-app-module-ts">3.2. Actualización de los módulos de <code>app.module.ts</code></a></li>
<li><a href="#truecreación-de-las-barras-laterales">3.3. Creación de las barras laterales</a></li>
<li><a href="#trueconfiguración-del-layout-de-la-aplicación">3.4. Configuración del layout de la aplicación</a></li>
<li><a href="#truecreación-de-un-módulo-para-los-módulos-de-angular-material">3.5. Creación de un módulo para los módulos de Angular Material</a></li>
<li><a href="#truecreación-de-los-módulos-de-la-aplicación">3.6. Creación de los módulos de la aplicación</a></li>
<li><a href="#truecreación-de-los-componentes-de-la-aplicación">3.7. Creación de los componentes de la aplicación</a></li>
<li><a href="#truecreación-de-las-rutas">3.8. Creación de las rutas</a></li>
</ul>
</li>
<li><a href="#trueprimeros-componentes-de-la-aplicación">4. Primeros componentes de la aplicación</a>
<ul class="sectlevel2">
<li><a href="#truebarra-lateral-y-la-barra-de-pie">4.1. Barra lateral y la barra de pie</a></li>
<li><a href="#truepágina-de-inicio">4.2. Página de inicio</a></li>
<li><a href="#trueformulario-de-creación-de-solicitudes">4.3. Formulario de creación de solicitudes</a>
<ul class="sectlevel3">
<li><a href="#trueañadiendo-mensajes-de-error-en-las-validaciones">4.3.1. Añadiendo mensajes de error en las validaciones</a></li>
<li><a href="#truedesactivación-condicional-del-botón-crear">4.3.2. Desactivación condicional del botón Crear</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#truecreación-de-un-servidor-json-para-datos-de-prueba">5. Creación de un servidor JSON para datos de prueba</a></li>
<li><a href="#truecreación-de-un-servicio-de-datos-de-persona">6. Creación de un servicio de datos de persona</a>
<ul class="sectlevel3">
<li><a href="#trueuso-de-variables-de-entorno">6.1. Uso de variables de entorno</a></li>
</ul>
</li>
<li><a href="#truemejora-de-la-carga-de-datos-en-el-formulario-de-creación-de-solicitudes">7. Mejora de la carga de datos en el formulario de creación de solicitudes</a>
<ul class="sectlevel3">
<li><a href="#trueactualizaciones-con-datos-asíncronos">7.1. Actualizaciones con datos asíncronos.</a></li>
<li><a href="#truemejora-del-código-de-actualización-del-formulario-con-patchvalue">7.2. Mejora del código de actualización del formulario con <code>patchValue</code></a></li>
<li><a href="#truelimpieza-de-datos-cuando-la-persona-no-existe">7.3. Limpieza de datos cuando la persona no existe</a></li>
</ul>
</li>
<li><a href="#trueguardado-de-datos-en-backend">8. Guardado de datos en backend</a>
<ul class="sectlevel2">
<li><a href="#trueactualización-de-los-datos-de-json-server">8.1. Actualización de los datos de JSON Server</a></li>
<li><a href="#truecreación-del-servicio-de-almacenamiento">8.2. Creación del servicio de almacenamiento</a></li>
<li><a href="#truemodificación-de-las-variables-de-entorno">8.3. Modificación de las variables de entorno</a></li>
</ul>
</li>
<li><a href="#truelista-de-reservas">9. Lista de reservas</a>
<ul class="sectlevel2">
<li><a href="#trueservicio-de-lista-de-reservas">9.1. Servicio de lista de reservas</a></li>
<li><a href="#truecarga-de-datos-en-el-componente-de-listado-de-solicitudes">9.2. Carga de datos en el componente de listado de solicitudes</a></li>
</ul>
</li>
<li><a href="#truelista-de-espacios">10. Lista de espacios</a>
<ul class="sectlevel2">
<li><a href="#truegeneración-del-servicio">10.1. Generación del servicio</a></li>
<li><a href="#trueprogramación-del-componente">10.2. Programación del componente</a></li>
<li><a href="#trueconfiguración-de-las-importaciones-del-módulo">10.3. Configuración de las importaciones del módulo</a></li>
<li><a href="#trueprogramación-de-la-presentación-de-datos">10.4. Programación de la presentación de datos</a></li>
<li><a href="#trueincorporación-de-funcionalidad-de-filtrado">10.5. Incorporación de funcionalidad de filtrado</a>
<ul class="sectlevel3">
<li><a href="#trueflujo-de-datos-entre-los-componentes">10.5.1. Flujo de datos entre los componentes</a></li>
<li><a href="#trueprogramación-de-la-parte-typescript-del-componente-de-tabla-de-datos">10.5.2. Programación de la parte TypeScript del componente de tabla de datos</a></li>
<li><a href="#truerefactorización-en-un-componente-dedicado-a-la-tabla-de-datos">10.5.3. Refactorización en un componente dedicado a la tabla de datos</a></li>
<li><a href="#trueconfiguración-de-la-página-de-listado-de-espacios">10.5.4. Configuración de la página de listado de espacios</a></li>
<li><a href="#truemodificación-del-módulo-de-espacios">10.5.5. Modificación del módulo de espacios</a></li>
<li><a href="#trueadaptación-del-servicio-de-búsqueda-para-que-acepte-parámetros-de-filtrado">10.5.6. Adaptación del servicio de búsqueda para que acepte parámetros de filtrado</a></li>
<li><a href="#truecreación-de-un-formulario-inicial-de-búsqueda">10.5.7. Creación de un formulario inicial de búsqueda</a></li>
<li><a href="#trueincorporación-de-capacidades-de-búsquedafiltrado">10.5.8. Incorporación de capacidades de búsqueda/filtrado</a>
<ul class="sectlevel4">
<li><a href="#trueconfiguración-del-filtro-de-búsqueda-en-el-componente-hijo">Configuración del filtro de búsqueda en el componente hijo</a></li>
<li><a href="#trueimplementacion-de-la-función-de-búsqueda-con-parámetros-en-el-componente-padre">Implementacion de la función de búsqueda con parámetros en el componente padre</a></li>
<li><a href="#truerecogida-de-datos-en-el-componente-padre">Recogida de datos en el componente padre</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#truecuadros-de-diálogo">11. Cuadros de diálogo</a>
<ul class="sectlevel2">
<li><a href="#truecuadro-de-diálogo-informativo">11.1. Cuadro de diálogo informativo</a></li>
</ul>
</li>
<li><a href="#trueeliminación-de-solicitudes">12. Eliminación de solicitudes</a>
<ul class="sectlevel2">
<li><a href="#truecreación-del-cuadro-de-diálogo-de-confirmación-de-eliminación">12.1. Creación del cuadro de diálogo de confirmación de eliminación.</a></li>
<li><a href="#truecreación-del-método-de-eliminación-de-solicitudes">12.2. Creación del método de eliminación de solicitudes</a></li>
<li><a href="#trueprogramación-de-la-lógica-del-cuadro-de-diálogo-de-eliminación">12.3. Programación de la lógica del cuadro de diálogo de eliminación</a></li>
<li><a href="#truepresentación-de-los-datos-en-el-cuadro-de-diálogo-de-eliminación">12.4. Presentación de los datos en el cuadro de diálogo de eliminación</a></li>
<li><a href="#truepresentación-del-botón-de-eliminación-en-el-listado-de-solicitudes">12.5. Presentación del botón de eliminación en el listado de solicitudes</a></li>
<li><a href="#trueactualización-de-solicitudes">12.6. Actualización de solicitudes</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./images/logocloudstic.png" alt="logocloudstic">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueresumen"><a class="anchor" href="#trueresumen"></a>Resumen</h2>
<div class="sectionbody">
<div class="paragraph">
<p>xxx</p>
</div>
<div class="ulist">
<div class="title">Objetivos</div>
<ul>
<li>
<p>xxx</p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Disponibles los repositorios usados en este tutorial.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>xxx</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueintroducción"><a class="anchor" href="#trueintroducción"></a>1. Introducción</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="truecreación-de-la-aplicación"><a class="anchor" href="#truecreación-de-la-aplicación"></a>2. Creación de la aplicación</h2>
<div class="sectionbody">
<div class="paragraph">
<p>El objetivo inicial es tener creado el proyecto con las librerías que vaya a usar.</p>
</div>
<div class="sect2">
<h3 id="truecreación-de-la-aplicación-con-el-cli-de-angular"><a class="anchor" href="#truecreación-de-la-aplicación-con-el-cli-de-angular"></a>2.1. Creación de la aplicación con el CLI de Angular</h3>
<div class="paragraph">
<p>Comenzamos creando la aplicación con el CLI de Angular.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng new angular-espacios

? Would you like to add Angular routing? Yes <i class="conum" data-value="1"></i><b>(1)</b>
? Which stylesheet format would you like to use? CSS</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Indicamos que queremos que genere el archivo de routing.</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">El archivo <code>app.routing.module.ts</code></div>
<div class="paragraph">
<p>Podemos crear la aplicación de Angular para que ya tenga configurado un archivo para las rutas principales de la aplicación. Las rutas indican a <code>Router</code> la pantalla que hay que mostrar cuando un usuario selecciona ir a la ruta indicada, bien porque hay un enlace en la aplicación que lleva ahí (p.e. un elemento del menú), o bien cualquier link o botón de la aplicación.</p>
</div>
<div class="paragraph">
<p>Las rutas las definiremos en la constante <code>routes</code> que aparece en el código siguiente. El código que se muestra es el archivo <code>app.routing.module.ts</code>, que es el que el CLI de Angular crea cuando aceptamos la opción <em>Angular routing</em> al crear el proyecto.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';

const routes: Routes = []; <i class="conum" data-value="1"></i><b>(1)</b>

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule]
})
export class AppRoutingModule { }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Array donde guardaremos las rutas principales admitidas por la aplicación y la pantalla que mostrará.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueinstalación-de-librerías"><a class="anchor" href="#trueinstalación-de-librerías"></a>2.2. Instalación de librerías</h3>
<div class="paragraph">
<p>En este proyecto usaremos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://material.angular.io/">Angular Material</a> como librería de componentes. Nos proporcionará botones, tarjetas, desplegables para selección de fechas (<em>date-pickers</em>), y demás.</p>
</li>
<li>
<p><a href="https://github.com/angular/flex-layout">Angular Flex-Layout</a> es una librería para la organización de componentes.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Usaremos Angular Flex-Layout para la organización de componentes porque es lo que usa <a href="http://angular-material.fusetheme.com/">Fuse Angular</a>, el template que se usa actualmente para el desarrollo de las aplicaciones de STIC.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Instalación de Angular Material con las opciones predeterminadas</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng add @angular/material

Would you like to proceed? Yes
✔ Package successfully installed.
? Choose a prebuilt theme name, or "custom" for a custom theme: Indigo/Pink        [ Preview: https://material.a
ngular.io?theme=indigo-pink ]
? Set up global Angular Material typography styles? Yes
? Set up browser animations for Angular Material? Yes</code></pre>
</div>
</div>
<div class="paragraph">
<p>Elegiremos las opciones por defecto, salvo en la de los tipos que seleccionaremos que sí para elegir los estilos tipográficos de Angular.</p>
</div>
<div class="paragraph">
<p>Instalación de Angular Flex-Layout</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ npm i -s @angular/flex-layout @angular/cdk</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Plugin de Angular Flex-Layout para Visual Studio: <a href="https://marketplace.visualstudio.com/items?itemName=1tontech.angular-material" class="bare">https://marketplace.visualstudio.com/items?itemName=1tontech.angular-material</a></p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecreación-del-scaffolding-de-la-aplicación"><a class="anchor" href="#truecreación-del-scaffolding-de-la-aplicación"></a>3. Creación del scaffolding de la aplicación</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sección crearemos todos los módulos, componentes y rutas que tendrá la aplicación. La aplicación constará de una barra lateral a la izquierda, un pie inferior y una zona central donde ser presentarán las pantallas de la aplicación. La figura siguiente ilustra la disposición de estos elementos.</p>
</div>
<div class="sect2">
<h3 id="truecreación-del-módulo-shared"><a class="anchor" href="#truecreación-del-módulo-shared"></a>3.1. Creación del módulo <code>shared</code></h3>
<div class="paragraph">
<p>Comenzaremos creando un módulo al que denominaremos  <code>shared</code> donde incluiremos todos los componentes compartidos de la aplicación, como son las dos barras laterales. En breve crearemos los componentes de las barras.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g module shared</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueactualización-de-los-módulos-de-app-module-ts"><a class="anchor" href="#trueactualización-de-los-módulos-de-app-module-ts"></a>3.2. Actualización de los módulos de <code>app.module.ts</code></h3>
<div class="paragraph">
<p>Como el módulo <code>shared</code> es un módulo transversal a la aplicación, lo incluiremos en <code>app.module.ts</code>. También incluiremos ahí el módulo de Flex-Layout que usaremos para la distribución de elementos en las pantallas de la aplicación. A continuación se muestran los cambios introducidos en <code>app.module.ts</code> para importar <code>SharedModule</code> y <code>FlexLayoutModule</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { BrowserModule } from '@angular/platform-browser';

import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';
import { SharedModule } from './shared/shared.module';
import { FlexLayoutModule } from '@angular/flex-layout';

@NgModule({
  declarations: [AppComponent],
  imports: [
    BrowserModule,
    AppRoutingModule, <i class="conum" data-value="1"></i><b>(1)</b>
    BrowserAnimationsModule, <i class="conum" data-value="2"></i><b>(2)</b>
    FlexLayoutModule, <i class="conum" data-value="2"></i><b>(2)</b>
    SharedModule, <i class="conum" data-value="3"></i><b>(3)</b>
  ],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Módulo incluido automáticamente por el CLI de Angular al crear el proyecto con la opción de <em>Angular routing</em>.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Módulo de efectos visuales introducido por nuestras nuevas librerías</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Módulo de Flex-Layout</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Módulo <code>shared</code></td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Angular Flex-Layout</div>
<div class="paragraph">
<p>Angular Flex-Layout es una librería de layout para la distribución de elementos en la interfaz de usuario. En este tutorial nos ajustaremos al funcionamiento básico:</p>
</div>
<div class="paragraph">
<p>En una etiqueta <code>&lt;div&gt;</code> incluiremos <code>fxLayout="row"</code> si queremos que los componentes que hay dentro del <code>div</code> se alineen uniformemente en horizontal (en una fila -<code>row</code>) o incluiremos <code>fxLayout="column"</code> si queremos que los componentes que hay dentro del <code>div</code> se alineen uniformemente en vertical (en una columna -<code>column</code>).</p>
</div>
<div class="paragraph">
<p>La distribución interna dentro del <code>div</code> la haremos con <code>fxLayoutAlign</code>, que admite 2 parámetros. El primero representa a la dirección usada en xLayout
` (horizontal o vertical) y el segundo representa a su perpendicular. Es decir:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Con <code>fxLayout="row"</code>, <code>fxLayoutAlign="&lt;row-alignment&gt; &lt;column-alignment&gt;"</code></p>
</li>
<li>
<p>Con <code>fxLayout="column"</code>, <code>fxLayoutAlign="&lt;column-alignment&gt; &lt;row-alignment&gt;"</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Los valores predeterminados son</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>start</code> (distribución desde el inicio, uno a continuación del otro) para la primera componente</p>
</li>
<li>
<p><code>stretch</code> (estirar ocupando todo) para la componente contraria (la perpendicular)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Consultar estos enlaces para más información:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.excellarate.com/blogs/getting-started-with-angular-flex-layout/">Getting started with Angular Flex-Layout</a></p>
</li>
<li>
<p><a href="https://tburleson-layouts-demos.firebaseapp.com/#/docs">Layout Demos</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-de-las-barras-laterales"><a class="anchor" href="#truecreación-de-las-barras-laterales"></a>3.3. Creación de las barras laterales</h3>
<div class="paragraph">
<p>Para cada barra, crearemos un componente, y lo incluiremos dentro del componente <code>shared</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g component shared/sidebar
$ ng g component shared/footbar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Al crear los componentes dentro de la carpeta del módulo <code>shared</code>, el CLI de Angular incluirá los componentes en <code>declarations</code>, indicando que son componentes del módulo y que podrán referenciarse entre ellos. Sin embargo, dichos compomentes aún no podrán ser utilizados por otros componentes o por otros módulos aunque incluyan al módulo <code>shared</code>.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Para que un componente pueda ser usado fuera del módulo en el que está definido, debe incluirse en el módulo <code>exports</code> del módulo. Los módulos que importen dichjo módulo ya sí podrán tener acceso a dichos componentes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación, modificaremos el módulo <code>shared</code>  <code>shared/shared.module.ts</code> para exportar los componentes de las barras laterales y de pie, y que se puedan usar fuera de su módulo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { SidebarComponent } from './sidebar/sidebar.component';
import { FootbarComponent } from './footbar/footbar.component';

@NgModule({
  declarations: [SidebarComponent, FootbarComponent],
  imports: [CommonModule],
  exports: [SidebarComponent, FootbarComponent], <i class="conum" data-value="1"></i><b>(1)</b>
})
export class SharedModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Incluir los componentes en el módulo para que puedan ser usados por otros módulos</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueconfiguración-del-layout-de-la-aplicación"><a class="anchor" href="#trueconfiguración-del-layout-de-la-aplicación"></a>3.4. Configuración del layout de la aplicación</h3>
<div class="paragraph">
<p>Crearemos un layout típico como el siguiente en el que tenemos una disposición horizontal con la barra laterial la izquierda y un bloque de dos componentes verticales a continuación.</p>
</div>
<div class="paragraph">
<p>$$$</p>
</div>
<div class="paragraph">
<p>Preparación de <code>app.component.html</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="row" fxLayoutAlign="start stretch" fxFill&gt; <i class="conum" data-value="1"></i><b>(1)</b>
  &lt;div&gt;
    &lt;app-sidebar&gt;&lt;/app-sidebar&gt;
  &lt;/div&gt;
  &lt;div fxFlex fxLayout="column"&gt;
    &lt;div fxFlex&gt;
      &lt;router-outlet&gt;&lt;/router-outlet&gt;
    &lt;/div&gt;
    &lt;div&gt;
      &lt;app-footbar&gt;&lt;/app-footbar&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Disposición en filas y alineación desde el inicio en horizontal y ocupando todo en vertical</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-de-un-módulo-para-los-módulos-de-angular-material"><a class="anchor" href="#truecreación-de-un-módulo-para-los-módulos-de-angular-material"></a>3.5. Creación de un módulo para los módulos de Angular Material</h3>
<div class="paragraph">
<p>La aplicación de este tutorial usa varios componentes de Angular, como botones, un módulo <em>steeper</em> para crear un asistente con varios pasos, un módulo de calendario, y demás. Lo más adecuado y eficiente es hacer que cada módulo de la aplicación sólo importe los módulos de los componentes que va a utilizar. Sin embargo, en este tutorial, por comodidad y facilidad crearemos un módulo que denominaremos <code>Material</code> que exportará todos los módulos de componentes de Angular Material que va a usar la aplicación en su conjunto. Posteriormente, importaremos este módulo desde el resto de módulos de la aplicación. Habrá módulos que necesiten todos los módulos de nuestro módulo <code>Material</code>. Sin embargo, habrá otros que quizá no los usen todos.</p>
</div>
<div class="paragraph">
<p>Para crear el módulo <code>Material</code> ejecutaremos</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g module material</code></pre>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Módulos de Angular Material</div>
<div class="paragraph">
<p>Para saber los módulos que tenemos que importar para usar un componente de Angular Material, en la sección de componentes de la <a href="https://material.angular.io/">documentación oficial de Angular Material</a> seleccionaremos el componente deseado, y en la pestaña <code>API</code> se indica el módulo que hay que importar para usar el componente de Material.</p>
</div>
<div class="paragraph">
<p>La figura siguiente ilustra el módulo para usar un botón Material.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/MatButtonModule.png" alt="MatButtonModule">
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>A continuación se indican los componentes Material que usará la aplicación de este tutorial:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Button</code> para los botones de la aplicación.</p>
</li>
<li>
<p><code>Card</code> para agrupar elementos en tarjetas.</p>
</li>
<li>
<p><code>DatePicker</code> para la selección de fechas.</p>
</li>
<li>
<p><code>Dialog</code> para cuadros de diálogo</p>
</li>
<li>
<p><code>Form field</code> para los campos de los formularios</p>
</li>
<li>
<p><code>Icon</code> para uso de iconos Material</p>
</li>
<li>
<p><code>Input</code> para elementos <code>input</code> de los formularios</p>
</li>
<li>
<p><code>List</code> para la creación de listas</p>
</li>
<li>
<p><code>Select</code> para listas desplegables</p>
</li>
<li>
<p><code>Snackbar</code> para barra de mensajes</p>
</li>
<li>
<p><code>Steeper</code> para definir un asistente con pasos</p>
</li>
<li>
<p><code>Table</code> para presentación de datos en tablas</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>También incluiremos el módulo de <code>Flex-Layout</code> para la distribución de elementos en la pantalla.</p>
</div>
<div class="paragraph">
<p>Incluiremos estos módulos en nuestro módulo <code>angular/angular.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

import { FlexLayoutModule } from '@angular/flex-layout';

import { MatButtonModule } from '@angular/material/button';
import { MatCardModule } from '@angular/material/card';
import { MatDatepickerModule } from '@angular/material/datepicker';
import { MatDialogModule } from '@angular/material/dialog';
import { MatExpansionModule } from '@angular/material/expansion';
import { MatFormFieldModule } from '@angular/material/form-field';
import { MatIconModule } from '@angular/material/icon';
import { MatInputModule } from '@angular/material/input';
import { MatListModule } from '@angular/material/list';
import { MatNativeDateModule } from '@angular/material/core';
import { MatSelectModule } from '@angular/material/select';
import { MatSnackBarModule } from '@angular/material/snack-bar';
import { MatStepperModule } from '@angular/material/stepper';
import { MatTableModule } from '@angular/material/table';

@NgModule({
  declarations: [],
  imports: [CommonModule],
  exports: [ <i class="conum" data-value="1"></i><b>(1)</b>
    FlexLayoutModule,  <i class="conum" data-value="2"></i><b>(2)</b>

    MatButtonModule, <i class="conum" data-value="3"></i><b>(3)</b>
    MatCardModule,
    MatDatepickerModule,
    MatDialogModule,
    MatExpansionModule,
    MatFormFieldModule,
    MatIconModule,
    MatInputModule,
    MatListModule,
    MatNativeDateModule,
    MatSelectModule,
    MatSnackBarModule,
    MatStepperModule,
    MatTableModule,
  ],
})
export class MaterialModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Lista de módulos Material exportados</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Módulo de Flex-Layout</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Módulos Material para nuestra aplicación</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Para una mayor legibilidad del código, se recomienda dejar ordenada las listas de <code>imports</code> y <code>exports</code> . También se recomienda usar grupos de <code>imports</code> y <code>exports</code>  (p.e. separando los módulos de Angular, de los genéricos de nuestra aplicación y otro bloque para los específicos).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-de-los-módulos-de-la-aplicación"><a class="anchor" href="#truecreación-de-los-módulos-de-la-aplicación"></a>3.6. Creación de los módulos de la aplicación</h3>
<div class="paragraph">
<p>A partir de la organización o descomposición funcional a un primer nivel de la aplicación crearemos los módulos de la aplicación Angular. En el caso de este tutorial, la aplicación va a estar formada funcionalmente por un módulo de solicitudes y un módulo de espacios. Además, se crerá un módulo <code>home</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>El módulo de solicitudes permitirá listar, crear, modificar y eliminar solitudes de espacios.</p>
</li>
<li>
<p>El módulo de espacios permitirá realizar consultas sobre ocupación de espacios.</p>
</li>
<li>
<p>El módulo <code>home</code> incluye el componente de inicio de la aplicación, que se mostrará al inicio o al tratar de ir a una ruta no disponible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Para reducir el tiempo y el tamaño de la carga inicial de la aplicación utilizaremos la técnica de <em>lazy loading</em>.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Lazy loading</div>
<div class="paragraph">
<p>De forma predeterminada, al iniciar la aplicación se cargan todos los módulos presentes en <code>app.module.ts</code>. Si colocamos ahí todos los módulos de la aplicación, en aplicaciones grandes con gran cantidad de módulos se ralentizará su carga y funcionamiento inicial. Esta situación se puede prevenir con lo que se conoce como <em>lazy loading</em>, que consiste en separar los distintos módulos de la aplicación y cargarlos conforme vayan siendo necesarios. El concepto <em>necesario</em> básicamente hace referencia a que el usuario acceda a las rutas de la aplicación que utilizan los componentes de un módulo. Esto tiene un resultado inmediato y es la reducción de los tiempos de carga.</p>
</div>
<div class="paragraph">
<p>Implementaremos <em>lazy loading</em> definiendo un módulo exclusivo de routing <code>app-routing.module.ts</code> que será importado en <code>app.module.ts</code>. Sin embargo, <code>app-routing.module.ts</code> pospone la carga de cada módulo concreto a la activación de la ruta asociada a la funcionalidad que proporciona cada módulo.</p>
</div>
<div class="paragraph">
<p>Archivo <code>app.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">...
import { AppRoutingModule } from './app-routing.module';
...
@NgModule({
  ...
  imports: [
    ...
    AppRoutingModule, <i class="conum" data-value="1"></i><b>(1)</b>
    ...
  ],
  ...
})
export class AppModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Importación del módulo global de routing</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Archivo <code>app-routing.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">const routes: Routes = [
  {
    path: 'items',
    loadChildren: () =&gt; import('./items/items.module').then(m =&gt; m.ItemsModule) <i class="conum" data-value="1"></i><b>(1)</b>
  }
];</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>El módulo <code>ItemsModule</code> no es cargado hasta que no se acceda a la ruta <code>items</code> en la URL.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>Crearemos los módulos con estas instrucciones. Incluiremos el parámetro <code>--routing</code> para que genere un archivo de rutas a nivel de módulo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g module main/home --routing
$ ng g module main/solicitudes --routing
$ ng g module main/espacios --routing</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Los archivos de rutas a nivel de módulo permiten organizar mejor las rutas de una aplicación. A un nivel general, <code>app-routing.module.ts</code> cargará las rutas de cada módulo, y cada módulo incluirá sus propias rutas locales relativas.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-de-los-componentes-de-la-aplicación"><a class="anchor" href="#truecreación-de-los-componentes-de-la-aplicación"></a>3.7. Creación de los componentes de la aplicación</h3>
<div class="paragraph">
<p>Un módulo organiza un bloque funcional del dominio de la aplicación (p.e. solicitudes, espacios, &#8230;&#8203;). Los componentes Angular permitirán llevar a cabo la funcionalidad del módulo.</p>
</div>
<div class="paragraph">
<p>La organización que seguiremos para los componentes de la aplicación podría resumirse de esta forma.</p>
</div>
<div class="paragraph">
<p>Dentro de la carpeta de cada módulo encontraremos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un archivo de módulo</p>
</li>
<li>
<p>El archivo de routing del módulo para implementar <em>lazy loading</em></p>
</li>
<li>
<p>Un directorio <code>pages</code> que contendrá a su vez un directorio para las funcionalidades</p>
<div class="ulist">
<ul>
<li>
<p><code>consultar</code></p>
</li>
<li>
<p><code>crear</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Un directorio <code>components</code> que contendrá a su vez un directorio <code>dialogo-eliminar</code> que incluirá un componente de cuadro de diálogo para la funcionalidad de eliminar.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title"><code>pages</code> vs <code>components</code></div>
<div class="paragraph">
<p>En la carpeta <code>pages</code> de la aplicación Angular incluiremos componentes Angular que van a ser directamente alcanzables por una ruta. Por ejemplo: <code>&lt;url-base&gt;/solicitudes/crear</code></p>
</div>
<div class="paragraph">
<p>En la carpeta <code>components</code> se incluirán componentes que no estarán directamen asociados a una ruta de la aplicación, pero que serán usados por otros componentes (que pondran estar en <code>components</code> o en <code>pages</code>).</p>
</div>
</div>
</div>
<div class="paragraph">
<p>La figura siguiente ilustra cómo quedaría la carpeta de un módulo:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/OrganizacionModulo.png" alt="OrganizacionModulo">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Organización básica de los archivos de la aplicación</div>
<div class="paragraph">
<p>A grandes rasgos la aplicación quedará organizada de esta forma:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>app.module.ts</code></p>
</li>
<li>
<p><code>app-routing.ts</code></p>
</li>
<li>
<p><code>app-component.ts</code></p>
</li>
<li>
<p><code>material</code></p>
<div class="ulist">
<ul>
<li>
<p><code>material.module.ts</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>shared</code></p>
<div class="ulist">
<ul>
<li>
<p><code>shared.module.ts</code></p>
</li>
<li>
<p><code>sidebar</code></p>
<div class="ulist">
<ul>
<li>
<p><code>sidebar.component.html</code></p>
</li>
<li>
<p><code>sidebar.component.ts</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>footbar</code></p>
<div class="ulist">
<ul>
<li>
<p><code>footbar.component.html</code></p>
</li>
<li>
<p><code>footbar.component.ts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>main</code></p>
<div class="ulist">
<ul>
<li>
<p><code>home</code></p>
<div class="ulist">
<ul>
<li>
<p><code>home-routing.module.ts</code></p>
</li>
<li>
<p><code>home.module.ts</code></p>
</li>
<li>
<p><code>pages</code></p>
<div class="ulist">
<ul>
<li>
<p><code>home.component.html</code></p>
</li>
<li>
<p><code>home.component.ts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>espacios</code></p>
<div class="ulist">
<ul>
<li>
<p><code>espacios-routing.module.ts</code></p>
</li>
<li>
<p><code>espacios.module.ts</code></p>
</li>
<li>
<p><code>pages</code></p>
<div class="ulist">
<ul>
<li>
<p><code>espacios.component.html</code></p>
</li>
<li>
<p><code>espacios.component.ts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Crearemos los componentes con estas instrucciones</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g c main/home/pages/home
$ ng g c main/espacios/pages/consultar
$ ng g c main/solicitudes/pages/consultar
$ ng g c main/solicitudes/pages/crear</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-de-las-rutas"><a class="anchor" href="#truecreación-de-las-rutas"></a>3.8. Creación de las rutas</h3>
<div class="paragraph">
<p>Aquí configuraremos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>el archivo <code>app-routing.module.ts</code> para hacer <em>lazy loading</em> indicando la ruta raíz del módulo y la ubicación de la clase del módulo.</p>
</li>
<li>
<p>cada uno de los archivos de rutas parciales de cada módulo.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Archivo de rutas desde <code>app-routing.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';

const routes: Routes = [
  {
    path: 'solicitudes', <i class="conum" data-value="1"></i><b>(1)</b>
    loadChildren: () =&gt; <i class="conum" data-value="2"></i><b>(2)</b>
      import('./main/solicitudes/solicitudes.module').then(
        (m) =&gt; m.SolicitudesModule
      ),
  },
  {
    path: 'espacios',
    loadChildren: () =&gt;
      import('./main/espacios/espacios.module').then((m) =&gt; m.EspaciosModule),
  },
  {
    path: '', <i class="conum" data-value="3"></i><b>(3)</b>
    loadChildren: () =&gt; <i class="conum" data-value="4"></i><b>(4)</b>
      import('./main/home/home.module').then((m) =&gt; m.HomeModule),
  },
  {
    path: '**', <i class="conum" data-value="5"></i><b>(5)</b>
    redirectTo: '',
  },
];

@NgModule({
  imports: [RouterModule.forRoot(routes)],
  exports: [RouterModule],
})
export class AppRoutingModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configuración de la URL de la ruta de un módulo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><em>Lazy loading</em> del módulo indicando el archivo y la clase del módulo</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Configuración de la ruta vacía</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Módulo asociado a la ruta vacía</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Expresión regular para indicar que redirija cualquier otro <code>path</code> no indicado al <code>path</code> vacío configurado anteriormente</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Los <code>path</code> son evaluados de arriba abajo. Hay que tener cuidado de no poner un <code>path</code> demasiado genérico arriba porque impediría la evaluación de otros <code>path</code> que estén configurados después.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación, creremos los archivos de rutas de cada módulo de la aplicación.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/home/home.routing.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { HomeComponent } from './pages/home/home.component';

const routes: Routes = [
  {
    path: '',
    children: [{ path: '', component: HomeComponent }],
  },
  {
    path: '**',
    redirectTo: '',
  },
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class HomeRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/espacios.routing.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { ConsultarComponent } from './pages/consultar/consultar.component';

const routes: Routes = [
  {
    path: '',
    children: [
      { path: 'consultar', component: ConsultarComponent },
      { path: '', redirectTo: 'consultar' },
    ],
  },
  {
    path: '**',
    redirectTo: 'consultar',
  },
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class EspaciosRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/solicitudes.routing.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { CrearComponent } from './pages/crear/crear.component';
import { ConsultarComponent } from './pages/consultar/consultar.component';

const routes: Routes = [
  {
    path: '',
    children: [
      { path: 'crear', component: CrearComponent },
      { path: 'consultar', component: ConsultarComponent },
      { path: '', redirectTo: 'consultar' },
    ],
  },
  {
    path: '**',
    redirectTo: 'crear',
  },
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class SolicitudesRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuación, comprobaremos que las rutas funcionan correctamente. Escribiremos las siguientes URL en el navegador y deben ser respetardas y no redirigirnos a la ruta predeterminada.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:4200/" class="bare">http://localhost:4200/</a></p>
</li>
<li>
<p><a href="http://localhost:4200/espacios/consultar" class="bare">http://localhost:4200/espacios/consultar</a></p>
</li>
<li>
<p><a href="http://localhost:4200/solicitudes/crear" class="bare">http://localhost:4200/solicitudes/crear</a></p>
</li>
<li>
<p><a href="http://localhost:4200/solicitudes/consultar" class="bare">http://localhost:4200/solicitudes/consultar</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Las siguientes rutas no serán reconocidas y seremos redirigidos a las rutas predetermninadas de cada módulo:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://localhost:4200/novale" class="bare">http://localhost:4200/novale</a></p>
</li>
<li>
<p><a href="http://localhost:4200/espacios" class="bare">http://localhost:4200/espacios</a></p>
</li>
<li>
<p><a href="http://localhost:4200/espacios/novale" class="bare">http://localhost:4200/espacios/novale</a></p>
</li>
<li>
<p><a href="http://localhost:4200/espacios/crear" class="bare">http://localhost:4200/espacios/crear</a></p>
</li>
<li>
<p><a href="http://localhost:4200/solicitudes" class="bare">http://localhost:4200/solicitudes</a></p>
</li>
<li>
<p><a href="http://localhost:4200/solicitudes/novale" class="bare">http://localhost:4200/solicitudes/novale</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueprimeros-componentes-de-la-aplicación"><a class="anchor" href="#trueprimeros-componentes-de-la-aplicación"></a>4. Primeros componentes de la aplicación</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="truebarra-lateral-y-la-barra-de-pie"><a class="anchor" href="#truebarra-lateral-y-la-barra-de-pie"></a>4.1. Barra lateral y la barra de pie</h3>
<div class="paragraph">
<p>Comenzaremos con la configuración del módulo <code>shared</code>. Como tanto la barra lateral como la de pie usarán componentes de Angular Material, habrá que importar el módulo <code>Material</code> creado anteriormente.</p>
</div>
<div class="paragraph">
<p>Además, como la barra lateral hará uso de los <code>routerLink</code> para cargar en la zona de páginas de la aplicación los componentes seleccionados, también tendrá que importarse <code>RouterModule</code>.</p>
</div>
<div class="paragraph">
<p>Así queda <code>shared/shared.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { SidebarComponent } from './sidebar/sidebar.component';
import { FootbarComponent } from './footbar/footbar.component';
import { MaterialModule } from '../material/material.module';
import { RouterModule } from '@angular/router';

@NgModule({
  declarations: [SidebarComponent, FootbarComponent],
  imports: [CommonModule, MaterialModule, RouterModule], <i class="conum" data-value="1"></i><b>(1)</b>
  exports: [SidebarComponent, FootbarComponent],
})
export class SharedModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Importación de los módulos de Material y de routing</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>No olvidar añadir <code>RouterModule</code> a los <code>imports</code> del módulo de la barra de navegación.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación se muestra el código de la barra lateral con el menú de operaciones de la aplicación.</p>
</div>
<div class="paragraph">
<p>Archivo <code>shared/sidebar/sidebar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column"&gt;
  &lt;button mat-button routerLink="/"&gt;Home&lt;/button&gt;
  &lt;hr /&gt;

  &lt;mat-accordion&gt;
    &lt;mat-expansion-panel&gt;
      &lt;mat-expansion-panel-header&gt;
        &lt;mat-panel-title&gt; Solicitudes &lt;/mat-panel-title&gt;
      &lt;/mat-expansion-panel-header&gt;
      &lt;div fxLayout="column"&gt;
        &lt;div&gt;
          &lt;button mat-button routerLink="./solicitudes/crear"&gt;Crear&lt;/button&gt;
        &lt;/div&gt;
        &lt;div&gt;
          &lt;button mat-button routerLink="./solicitudes/consultar"&gt;
            Consultar
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/mat-expansion-panel&gt;

    &lt;mat-expansion-panel&gt;
      &lt;mat-expansion-panel-header&gt;
        &lt;mat-panel-title&gt; Espacios &lt;/mat-panel-title&gt;
      &lt;/mat-expansion-panel-header&gt;
      &lt;div fxLayout="column"&gt;
        &lt;a mat-button routerLink="./espacios/consultar"&gt;Consultar&lt;/a&gt;
      &lt;/div&gt;
    &lt;/mat-expansion-panel&gt;
  &lt;/mat-accordion&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>La barra del pie estará formada por tres botones con los enlaces a aviso legal y las políticas de privacidad y accesibilidad.</p>
</div>
<div class="paragraph">
<p>Archivo <code>shared/footbar/footbar.component.html</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="row"&gt;
  &lt;a mat-button href="https://www.ual.es/avisolegal" target="_blank"
    &gt;Aviso legal&lt;/a
  &gt;

  &lt;a mat-button href="https://www.ual.es/politicaprivacidad" target="_blank"
    &gt;Política de Privacidad&lt;/a
  &gt;

  &lt;a mat-button href="https://www.ual.es/accesibilidad" target="_blank"
    &gt;Política de Accesibilidad&lt;/a
  &gt;
&lt;/div&gt;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truepágina-de-inicio"><a class="anchor" href="#truepágina-de-inicio"></a>4.2. Página de inicio</h3>
<div class="paragraph">
<p>La página de inicio dará la bienvenida usando componentes Material y permitirá acceder a la consulta de espacios.</p>
</div>
<div class="paragraph">
<p>Comenzaremos añadiendo el módulo de componentes Material de nuestra aplicación al módulo <code>Home</code>.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/home/home.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

import { HomeRoutingModule } from './home-routing.module';
import { HomeComponent } from './pages/home/home.component';
import { MaterialModule } from '../../material/material.module';

@NgModule({
  declarations: [HomeComponent],
  imports: [CommonModule, HomeRoutingModule, MaterialModule], <i class="conum" data-value="1"></i><b>(1)</b>
})
export class HomeModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inclusión de nuestro módulo de Material</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para la página de inicio busca tu propia imagen, colócala en <code>assets/images/</code> y añade un código como este.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/home/pages/home.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="row" fxLayoutAlign="center center"&gt;
  &lt;mat-card class="text-center" fxLayout="column" fxLayoutAlign="center center"&gt;
    &lt;img src="assets/images/empty.png" /&gt;
    &lt;h1&gt;¡Hola! ¿Aún no has reservado ningún espacio?&lt;/h1&gt;
    &lt;p&gt;
      Si deseas reservar un espacio, consulta la disponibilidad a través del
      siguiente enlace.
    &lt;/p&gt;
    &lt;button
      [routerLink]="['/espacios/consultar']"
      mat-stroked-button
      ngClass.xs="mat-fab"
      color="primary"
    &gt;
      &lt;span fxHide fxShow.gt-xs&gt;Ver disponibilidad de espacios&lt;/span&gt;
    &lt;/button&gt;
  &lt;/mat-card&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Quedará algo así:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/Home.png" alt="Home">
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueformulario-de-creación-de-solicitudes"><a class="anchor" href="#trueformulario-de-creación-de-solicitudes"></a>4.3. Formulario de creación de solicitudes</h3>
<div class="paragraph">
<p>Trabajaremos con formularios reactivos. Esto nos permitirá desviar la lógica a la parte TypeScript del componente y dejar más limpia la parte HTML del componente. Cada objeto de la pantalla HTML tendrá su homólogo en la parte TypeScript lo que permitirá acceder y modificar sus datos, quedando el HTML y el TS totalmente conectado. Esto supone:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Importar <code>ReactiveFormsModule</code> en el módulo de solicitudes</p>
</li>
<li>
<p>Crear un objeto formulario en la parte TyepScript del componente</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Comenzamos con las importaciones al módulo que contiene el componente en el que está nuestro componente de formulario. Hay que importar el módulo <code>ReactiveFormsModule</code> y nuestro módulo Material</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/solicitudes.module.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

import { SolicitudesRoutingModule } from './solicitudes-routing.module';
import { ConsultarComponent } from './pages/consultar/consultar.component';
import { CrearComponent } from './pages/crear/crear.component';
import { ReactiveFormsModule } from '@angular/forms';
import { MaterialModule } from '../../material/material.module';

@NgModule({
  declarations: [ConsultarComponent, CrearComponent],
  imports: [
    CommonModule,
    SolicitudesRoutingModule,
    ReactiveFormsModule, <i class="conum" data-value="1"></i><b>(1)</b>
    MaterialModule, <i class="conum" data-value="2"></i><b>(2)</b>
  ],
})
export class SolicitudesModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Módulo de formularios reactivos</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Módulo de los componentes Material de nuestra aplicación</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Si no se importa <code>ReactiveFormsModule</code> tendremos un error del tipo</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="code" class="language-code hljs">Uncaught (in promise): NullInjectorError: R3InjectorError(SolicitudesModule)[FormBuilder -&gt; FormBuilder -&gt; FormBuilder -&gt; FormBuilder]:
  NullInjectorError: No provider for FormBuilder!
---</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación crearemos la parte TypeScript del componente de creación de solicitudes. Se trata de:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Definir el objeto formulario con los campos que habrá en la pantalla</p>
</li>
<li>
<p>Para cada campo se define si tiene valores predeterminados, si está desactivado y sus validadores.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>En un formulario reactivo los campos se definen como pares JSON con el nombre del campo y un array en el que se puede indicar valores predeterminados, validadores, si está desactivado, y demás.</p>
</div>
<div class="paragraph">
<p>Este componente tendrá que implementar un método <code>save</code> que sea llamado por la parte HTML del componente cuando se quiera crear la solicitud. Será un método que por ahora simplemente imprimirá por consola los valores introducidos a modo de comprobación. Posteriormente, se llamará a un servicio que crearemos más adelante y que se dedicará a almacenar la solicitud.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/solicitudes.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';

@Component({
  selector: 'app-crear',
  templateUrl: './crear.component.html',
  styleUrls: ['./crear.component.css'],
})
export class CrearComponent implements OnInit {
  formHorario: FormGroup = this.fb.group({ <i class="conum" data-value="1"></i><b>(1)</b>
    nombre: [{ value: '', disabled: true }], <i class="conum" data-value="2"></i><b>(2)</b>
    cargo: [, [Validators.required]], <i class="conum" data-value="3"></i><b>(3)</b>
    unidad: [{ value: '', disabled: true }],
    telefono: [{ value: '', disabled: true }],
    email: [, [Validators.required, Validators.email]], <i class="conum" data-value="4"></i><b>(4)</b>
    tipo: [,],
    nombreActividad: [, [Validators.required, Validators.minLength(5)]], <i class="conum" data-value="5"></i><b>(5)</b>
    start: [,],
    end: [,],
    dia: [,],
    horaInicio: [,],
    horaFin: [,],
  });

  cargos: string[] = [ <i class="conum" data-value="6"></i><b>(6)</b>
    'Profesor Titular de Universidad',
    'Director de Secretariado de Innovación Tecnológica',
  ];


  diasSemana: string[] = [ <i class="conum" data-value="7"></i><b>(7)</b>
    'lunes',
    'martes',
    'miercoles',
    'jueves',
    'viernes',
    'sabado',
    'domingo',
  ];

  horas = Array.from(Array(24).keys()); <i class="conum" data-value="8"></i><b>(8)</b>

  constructor(private fb: FormBuilder)  {} <i class="conum" data-value="9"></i><b>(9)</b>

  ngOnInit(): void { <i class="conum" data-value="10"></i><b>(10)</b>
    this.formHorario.controls['nombre'].setValue('Manuel Torres Gil');
    this.formHorario.controls['unidad'].setValue('Informática');
    this.formHorario.controls['telefono'].setValue('84030');
  }

  save() { <i class="conum" data-value="11"></i><b>(11)</b>
    console.log('this.formHorario :&gt;&gt; ', this.formHorario);
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Los campos son creados en JSON como valores del método <code>group</code> del objeto <code>FormBuilder</code> que representa al formulario.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Definición del nombre del campo y su configuración (valores predeterminados, validadores, si está desactivado, &#8230;&#8203;)</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Uso del validador <code>Required</code>. Va después del valor inicial</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Se puede usar una lista de validadores</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Validador de longitud mínima</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Array para inicializar la lista de cargos</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Array para inicializar la lista de día de la semana en un listbox</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Array para inicializar las horas en un listbox</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Inyección de <code>FormBuilder</code></td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Inicialización de valores</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Método <code>save</code> inicializado con código de prueba</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Validadores</div>
<div class="paragraph">
<p>Angular proporciona una serie de validadores útiles para la validación de campos. Destacan <code>required, email, min(&lt;valor&gt;), max(&lt;valor&gt;), minLength(&lt;valor&gt;), maxLength(&lt;valor&gt;)</code> y <code>pattern(&lt;expresión-regular&gt;)</code>. <code>email</code> permite validar si el valor introducido se ajusta a un email. Con <code>pattern</code> se pueden definir expresiones regulares para la validación de datos de los controles del formulario.</p>
</div>
<div class="paragraph">
<p>El uso de validadores deja un código muy limpio comparado con hacerlo mediante métodos propios que además de ser implementados en la parte TypeScript deberían ser llamados en la parte HTML. Además, la posibilidad de usar varios incluyéndolos en un array facilita mucho las validaciones compuestas.</p>
</div>
<div class="paragraph">
<p>Por último, el formulario (sus datos) no será considerado como válido mientras todos sus campos no hayan cumplido con sus validadores.</p>
</div>
<div class="paragraph">
<p>Más información en la <a href="https://angular.io/api/forms/Validators">documentación oficial</a>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>A continuación crearemos la parte visual del compomente. Se trata de un formulario reactivo ligado al objeto <code>formHorario</code> creado en la parte TS. Organizaremos sus elementos en tres tarjetas (datos personales, datos de la actividad, horario de la reserva). Usaremos un compomente <code>Datepicker</code> de Material para la selección de fechas. Las horas las seleccionaremos mediante listas desplegables. Se trata de la primera aproximación al formulario. Por ahora:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>No usamos servicios de recuperación de los datos del usuario</p>
</li>
<li>
<p>Las horas las gestionaremos por ahora con listas desplegables con valores sólo para las horas, sin minutos.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/solicitudes.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxFlexAlign="center" fxLayoutAlign="center center"&gt;
  &lt;form [formGroup]="formHorario"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;h1&gt;Crear reserva&lt;/h1&gt;
    &lt;hr /&gt;
    &lt;div fxLayout="column wrap" fxLayoutGap="20px"&gt;
      &lt;mat-card&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;mat-card-subtitle&gt;Datos personales&lt;/mat-card-subtitle&gt;
        &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt; <i class="conum" data-value="3"></i><b>(3)</b>
              &lt;mat-label&gt;Email&lt;/mat-label&gt; <i class="conum" data-value="4"></i><b>(4)</b>
              &lt;input
                matInput <i class="conum" data-value="5"></i><b>(5)</b>
                formControlName="email" <i class="conum" data-value="6"></i><b>(6)</b>
              /&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Nombre&lt;/mat-label&gt;
              &lt;input matInput formControlName="nombre" /&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;

          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Unidad/Departamento/Centro&lt;/mat-label&gt;
              &lt;input matInput formControlName="unidad" /&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Teléfono&lt;/mat-label&gt;
              &lt;input matInput formControlName="telefono" /&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Cargo&lt;/mat-label&gt;
              &lt;div&gt;
                &lt;mat-select formControlName="cargo"&gt; <i class="conum" data-value="7"></i><b>(7)</b>
                  &lt;mat-option
                    *ngFor="let cargo of cargos"
                    value="{{ cargo }}"
                    &gt;{{ cargo }}&lt;/mat-option
                  &gt;
                &lt;/mat-select&gt;
              &lt;/div&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;&lt;/div&gt;
        &lt;/div&gt;
      &lt;/mat-card&gt;

      &lt;mat-card&gt; <i class="conum" data-value="8"></i><b>(8)</b>
        &lt;mat-card-subtitle&gt;Datos de la actividad&lt;/mat-card-subtitle&gt;
        &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
          &lt;div&gt;
            &lt;mat-form-field appearance="outline"&gt;
              &lt;mat-label&gt;Tipo&lt;/mat-label&gt;
              &lt;mat-select formControlName="tipo"&gt;
                &lt;mat-option value="docente"&gt;Docente&lt;/mat-option&gt;
                &lt;mat-option value="noDocente"&gt;No docente&lt;/mat-option&gt;
              &lt;/mat-select&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Actividad&lt;/mat-label&gt;
              &lt;input matInput formControlName="nombreActividad" /&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/mat-card&gt;

      &lt;mat-card&gt;
        &lt;mat-card-subtitle&gt;Horario de la reserva&lt;/mat-card-subtitle&gt;
        &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="fill"&gt;
              &lt;mat-label&gt;Rango de fechas&lt;/mat-label&gt;
              &lt;mat-date-range-input [rangePicker]="picker"&gt; <i class="conum" data-value="9"></i><b>(9)</b>
                &lt;input
                  matStartDate
                  formControlName="start"
                  placeholder="Start date"
                /&gt;
                &lt;input
                  matEndDate
                  formControlName="end"
                  placeholder="End date"
                /&gt;
              &lt;/mat-date-range-input&gt;
              &lt;mat-datepicker-toggle
                matSuffix
                [for]="picker"
              &gt;&lt;/mat-datepicker-toggle&gt;
              &lt;mat-date-range-picker #picker&gt;&lt;/mat-date-range-picker&gt; <i class="conum" data-value="10"></i><b>(10)</b>
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline"&gt;
              &lt;mat-label&gt;Día&lt;/mat-label&gt;
              &lt;mat-select formControlName="dia"&gt; <i class="conum" data-value="11"></i><b>(11)</b>
                &lt;mat-option *ngFor="let day of daysOfWeek" value="{{ day }}"&gt;{{
                  day | titlecase
                }}&lt;/mat-option&gt;
              &lt;/mat-select&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline"&gt;
              &lt;mat-label&gt;Hora de inicio&lt;/mat-label&gt;
              &lt;mat-select formControlName="horaInicio"&gt; <i class="conum" data-value="12"></i><b>(12)</b>
                &lt;mat-option *ngFor="let hour of hours" value="{{ hour }}"&gt;{{
                  hour
                }}&lt;/mat-option&gt;
              &lt;/mat-select&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline"&gt;
              &lt;mat-label&gt;Hora de fin&lt;/mat-label&gt;
              &lt;mat-select formControlName="horaFin"&gt; <i class="conum" data-value="13"></i><b>(13)</b>
                &lt;mat-option *ngFor="let hour of hours" value="{{ hour }}"&gt;{{
                  hour
                }}&lt;/mat-option&gt;
              &lt;/mat-select&gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;
        &lt;/div&gt;
        &lt;div fxLayout="row" fxLayoutAlign="end"&gt;
          &lt;button mat-stroked-button color="primary" (click)="save()"&gt; <i class="conum" data-value="14"></i><b>(14)</b>
            Guardar
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/mat-card&gt;
    &lt;/div&gt;
  &lt;/form&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Objeto formulario ligado al formulario reactivo <code>formHorario</code> definido en el TS</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Tarjeta para elementos de datos personales</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Creación de campo de formulario Material</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Etiqueta</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Input de tipo Material</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Vinculación del campo al elemento <code>email</code> al elemento del formulario de la parte TS</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Listbox inicializado con los valores de la parte TS</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Tarjeta para los datos de la actividad</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Elemento para los datos del rango de fechas</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Elemento para la selección del rango de fechas</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Desplegable para la selección de días</td>
</tr>
<tr>
<td><i class="conum" data-value="12"></i><b>12</b></td>
<td>Desplegable para la selección de la hora de inicio</td>
</tr>
<tr>
<td><i class="conum" data-value="13"></i><b>13</b></td>
<td>Desplegable para la selección de la hora de fin</td>
</tr>
<tr>
<td><i class="conum" data-value="14"></i><b>14</b></td>
<td>Llamada al método que gestionará el formulario</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si pulsamos el botón <code>Crear</code> y no se cumple alguno de los validadores, los campos no válidos aparecerán marcados en rojo. Y si activamos en el navegador las Herramientas para desarrolladores, como el método <code>save</code> hace un <code>console.log</code> del objeto <code>formHorario</code>, vemos que su estado es <code>INVALID</code>. Esto se debe a que no se está cumpliendo alguno de sus validadores.</p>
</div>
<div class="paragraph">
<p>A continuación veremos cómo mostrar mensajes de error en las validaciones y cómo desactivar el botón del formulario hasta que éste sea válido.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/CrearReservaInvalid.png" alt="CrearReservaInvalid">
</div>
</div>
<div class="sect3">
<h4 id="trueañadiendo-mensajes-de-error-en-las-validaciones"><a class="anchor" href="#trueañadiendo-mensajes-de-error-en-las-validaciones"></a>4.3.1. Añadiendo mensajes de error en las validaciones</h4>
<div class="paragraph">
<p>Necesitamos un método genérico que nos indique si un campo tiene errores o no. En nuestro caso, los campos tendrán errores si no se cumplen algunos de los validadores. Introduciremos además la condición de que hayan sido tocados para que no se inicialmente no se consideren erróneos los campos que aún no han sido tocados.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/solicitudes.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">  ...
  isNotValidField(field: string) {
    return (
      this.formHorario.controls[field].errors &amp;&amp;
      this.formHorario.controls[field].touched
    );
  }
  ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Definimos una clase <code>invalid-mat-form-field</code> en <code>styles.css</code> para personalizar los mensajes de error en los campos no válidos</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="css" class="language-css hljs">.invalid-mat-form-field {
  font-size: small;
  color: red;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Por último, añadimos la presentación condicional del error en un elemento <code>&lt;span&gt;</code> si <code>isNotValidField</code> devuelve que el campo no es válido.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/solicitudes.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">...
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Email&lt;/mat-label&gt;
              &lt;input
                matInput
                formControlName="email"
              /&gt;
              &lt;span class="invalid-mat-form-field" *ngIf="isNotValidField('email')"
                &gt;* Formato de email incorrecto&lt;/span
              &gt; <i class="conum" data-value="1"></i><b>(1)</b>
            &lt;/mat-form-field&gt;
...
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Actividad&lt;/mat-label&gt;
              &lt;input matInput formControlName="nombreActividad" /&gt;
              &lt;span
                class="invalid-mat-form-field"
                *ngIf="isNotValidField('nombreActividad')"
                &gt;Al menos 5 caracteres&lt;/span
              &gt; <i class="conum" data-value="2"></i><b>(2)</b>
            &lt;/mat-form-field&gt;
...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Presentación de mensaje de error si el email no es válido</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Presentación de mensaje de error si la actividad no es válida</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación se muestra el efecto de la presentación del mensaje de error cuando los campos no son válidos.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/IsNotValidField.png" alt="IsNotValidField">
</div>
</div>
</div>
<div class="sect3">
<h4 id="truedesactivación-condicional-del-botón-crear"><a class="anchor" href="#truedesactivación-condicional-del-botón-crear"></a>4.3.2. Desactivación condicional del botón Crear</h4>
<div class="paragraph">
<p>Queremos que el botón Crear no esté disponible si el formulario no es válido. Para ello, comenzaremos añadiendo un método al TS del componente que indique si el formulario es válido o no basándonse en la propiedad <code>valid</code> de los formularios.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">...
  isValidForm() {
    return this.formHorario.valid;
  }
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>Ahora sólo falta configurar la propiedad <code>disabled</code> del formulario en función de lo que devuelva el método <code>isValidForm</code>.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">...
          &lt;button
            mat-stroked-button
            color="primary"
            (click)="save()"
            [disabled]="!isValidForm()" <i class="conum" data-value="1"></i><b>(1)</b>
          &gt;
            Crear
          &lt;/button&gt;
...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Desactivación del botón Crear si el formulario no es válido</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si ahora alguno de los campos no cumple sus validaciones el formulario no será válido y el botón Crear estará desactivado.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/BotonCrearDisabled.png" alt="BotonCrearDisabled">
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecreación-de-un-servidor-json-para-datos-de-prueba"><a class="anchor" href="#truecreación-de-un-servidor-json-para-datos-de-prueba"></a>5. Creación de un servidor JSON para datos de prueba</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Con el fin de poder simular el funcionamiento de servicios de backend sin necesidad de montar un backend y su complejidad asociada, para desarrollar la aplicación en Angular podemos usar algo con menor funcionalidad pero que nos permita realizar nuestras operaciones CRUD básicas.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/typicode/json-server">JSON-server</a> nos ofrece la posibilidad de tener de forma muy sencilla un prototipo de API REST totalmente funcional sin necesidad de programar nada.</p>
</div>
<div class="paragraph">
<p>Se instala de forma sencilla con</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ npm install -g json-server</code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuación, hay que crear un archivo JSON con los datos que va a manejar inicialmente la API.</p>
</div>
<div class="paragraph">
<p>Incluiremos un archivo <code>db.json</code> en nuestro proyecto para que contemos con un conjunto inicial de datos.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
  "personas": [
    {
      "email": "mtorres@ual.es",
      "nombre": "Manuel Torres Gil",
      "telefono": "84030",
      "unidad": "Departamento de Informática",
      "cargo": [
        "Profesor Titular de Universidad",
        "Director de Secretariado de Innovación Tecnológica"
      ],
      "docente": true
    },
    {
      "email": "ggf906@ual.es",
      "nombre": "Francisco José García García",
      "telefono": "N/D",
      "unidad": "STIC",
      "cargo": ["Gestor Informática"],
      "docente": false
    }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Iniciamos JSON Server con</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ json-server --watch db.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>El puerto predeterminado en que se ofrece la API REST es el 3000. Así, tendríamos una API REST funcional en <a href="http://localhost:3000/personas" class="bare">http://localhost:3000/personas</a></p>
</div>
<div class="paragraph">
<p>Para iniciar JSON Server en otro puerto, pasamos al final el parámetro <code>--port</code> seguido de un número de puerto.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ json-server --watch db.json --port 3002</code></pre>
</div>
</div>
<div class="paragraph">
<p>En este caso tendríamos la API REST funcional en <a href="http://localhost:3002/personas" class="bare">http://localhost:3002/personas</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecreación-de-un-servicio-de-datos-de-persona"><a class="anchor" href="#truecreación-de-un-servicio-de-datos-de-persona"></a>6. Creación de un servicio de datos de persona</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sección crearemos un servicio que recupere datos de persona. Comenzaremos creando un servicio.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g service services/persona</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Los servicios los organizaremos en una carpeta <code>services</code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Inclusión de los servicios en la organización básica de los archivos de la aplicación</div>
<div class="paragraph">
<p>A grandes rasgos la aplicación quedará organizada de esta forma:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>app.module.ts</code></p>
</li>
<li>
<p><code>app-routing.ts</code></p>
</li>
<li>
<p><code>app-component.ts</code></p>
<hr>
</li>
<li>
<p><code>services</code> // Carpeta para la organización de servicios</p>
<div class="ulist">
<ul>
<li>
<p><code>persona.service.ts</code> // Servicio para personas</p>
<hr>
</li>
</ul>
</div>
</li>
<li>
<p><code>material</code></p>
<div class="ulist">
<ul>
<li>
<p><code>material.module.ts</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>shared</code></p>
<div class="ulist">
<ul>
<li>
<p><code>shared.module.ts</code></p>
</li>
<li>
<p><code>sidebar</code></p>
<div class="ulist">
<ul>
<li>
<p><code>sidebar.component.html</code></p>
</li>
<li>
<p><code>sidebar.component.ts</code></p>
</li>
</ul>
</div>
</li>
<li>
<p><code>footbar</code></p>
<div class="ulist">
<ul>
<li>
<p><code>footbar.component.html</code></p>
</li>
<li>
<p><code>footbar.component.ts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>main</code></p>
<div class="ulist">
<ul>
<li>
<p><code>home</code></p>
<div class="ulist">
<ul>
<li>
<p><code>home-routing.module.ts</code></p>
</li>
<li>
<p><code>home.module.ts</code></p>
</li>
<li>
<p><code>pages</code></p>
<div class="ulist">
<ul>
<li>
<p><code>home.component.html</code></p>
</li>
<li>
<p><code>home.component.ts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p><code>espacios</code></p>
<div class="ulist">
<ul>
<li>
<p><code>espacios-routing.module.ts</code></p>
</li>
<li>
<p><code>espacios.module.ts</code></p>
</li>
<li>
<p><code>pages</code></p>
<div class="ulist">
<ul>
<li>
<p><code>espacios.component.html</code></p>
</li>
<li>
<p><code>espacios.component.ts</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Importación de HttpClientModule</div>
<div class="paragraph">
<p>El servicio usará la clase HttpClient. Para usar esta clase es necesario que previamente se haya importado HttpClientModule. La mayoría de las aplicaciones realizan esta importación en app.module.ts.</p>
</div>
<div class="paragraph">
<p>Archivo <code>app.module.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">...
  imports: [
    BrowserModule,
    HttpClientModule, <i class="conum" data-value="1"></i><b>(1)</b>
    ...
  ],</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Incorporación a la lista de <code>imports</code> de la aplicación</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>No importar este módulo provocaría este error al usar el servicio indicando que no existe provider para HttpClient:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/errorHttpClientModule.png" alt="errorHttpClientModule">
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>HttpClientModule en <code>app.module.ts</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { FlexLayoutModule } from '@angular/flex-layout';
import { BrowserModule } from '@angular/platform-browser';
import { HttpClientModule } from '@angular/common/http'; <i class="conum" data-value="1"></i><b>(1)</b>

import { AppRoutingModule } from './app-routing.module';
import { AppComponent } from './app.component';
import { SharedModule } from './shared/shared.module';
import { BrowserAnimationsModule } from '@angular/platform-browser/animations';

@NgModule({
  declarations: [AppComponent],
  imports: [
    BrowserModule,
    HttpClientModule, <i class="conum" data-value="2"></i><b>(2)</b>
    AppRoutingModule,
    BrowserAnimationsModule,
    FlexLayoutModule,
    SharedModule,
  ],
  providers: [],
  bootstrap: [AppComponent],
})
export class AppModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Importación del módulo de <code>HttpClientModule</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Incorporación a la lista de <code>imports</code></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para implementar el servicio:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Inyectaremos <code>HttpClient</code> en el constructor para poder realizar peticiones HTTP</p>
</li>
<li>
<p>Inicializaremos la URL de acceso a la API</p>
</li>
<li>
<p>Implementaremos un método que permita la recuperación de una persona por su email.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Servicio en <code>services/people.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root',
})
export class PeopleService {
  url = 'http://localhost:3000/personas';
  constructor(private http: HttpClient) {}

  findOne(email: any): Observable&lt;any&gt; {
    return this.http.get(`${this.url}?email=${email}`);
  }
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="trueuso-de-variables-de-entorno"><a class="anchor" href="#trueuso-de-variables-de-entorno"></a>6.1. Uso de variables de entorno</h4>
<div class="paragraph">
<p>En el ejemplo anterior, teníamos la URL en el propio código de la aplicación. Esto presenta problemas de mantenimiento porque si cambia la URL tendremos que hacer cambios en todos los archivos en los que aparezca. Además, tendremos que ir cambiando el valor en función de si estamos en un entorno de desarrollo o en el entorno de producción.</p>
</div>
<div class="paragraph">
<p>Angular permite la definición de archivos de variables de entorno y permite tener archivos separados para los entornos de desarrollo y producción. Los procesos de despligue tomarán los valores del archivo del entorno de producción, mientras que cuando estemos desarrollando <code>ng serve</code> toma los valores del entorno de desarrollo.</p>
</div>
<div class="paragraph">
<p>Estos son los archivos de variables de entorno que manejaremos en nuestra aplicación Angular:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>environments/environments.ts</code>: Variables de entorno para desarrollo</p>
</li>
<li>
<p><code>environments/environments.prod.ts</code>: Variables de entorno para producción</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A continuación se muestra el archivo de variables de entorno para desarrollo.</p>
</div>
<div class="paragraph">
<p>Archivo <code>environments/environments.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">export const environment = {
  production: false,
  urlPersonas: 'http://localhost:3000/personas', <i class="conum" data-value="1"></i><b>(1)</b>
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Una vez definido, podremos usar sus variables en el resto de la aplicación. Veamos cómo quedaría el servicio usando variables de entorno.</p>
</div>
<div class="paragraph">
<p>Servicio en <code>services/people.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { environment } from './../../environments/environment'; <i class="conum" data-value="1"></i><b>(1)</b>
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root',
})
export class PeopleService {
  constructor(private http: HttpClient) {}

  findOne(email: any): Observable&lt;any&gt; {
    return this.http.get(`${environment.urlPersonas}?email=${email}`); <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Importación de variables de entorno de desarrollo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Uso de las variables de entorno</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hay que tener cuidado a la hora de importar las variables de entorno y no importar el de producción.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>También habría que configurar las variables de entorno de producción. A continuación se muestra un ejemplo para producción.</p>
</div>
<div class="paragraph">
<p>Archivo <code>environments/environments.prod.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">export const environment = {
  production: true,
  urlPersonas: 'http://&lt;your-production-people-api-server&gt;/personas', <i class="conum" data-value="1"></i><b>(1)</b>
};</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Configuración para producción</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truemejora-de-la-carga-de-datos-en-el-formulario-de-creación-de-solicitudes"><a class="anchor" href="#truemejora-de-la-carga-de-datos-en-el-formulario-de-creación-de-solicitudes"></a>7. Mejora de la carga de datos en el formulario de creación de solicitudes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hasta ahora, al inicializar el formulario de creación de solicitudes, los datos de la persona eran incluidos sin capacidad de ser cambiados mediante una inicialización de valores en el método <code>ngOnInit</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">  ngOnInit(): void {
    this.formHorario.controls['nombre'].setValue('Manuel Torres Gil');
    this.formHorario.controls['unidad'].setValue('Informática');
    this.formHorario.controls['telefono'].setValue('84030');
  }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sin embargo, el funcionamiento esperado es que estos datos sean inicializados a partir del email introducido en el formulario. Actualmente contamos con el método <code>findOne()</code> en el servicio <code>PersonaService</code> que permite recuperar los datos de una persona a partir de su email. Sin embargo, esto aún no está siendo explotado por la aplicación. Veamos cómo hacerlo.</p>
</div>
<div class="paragraph">
<p>En primer lugar, dejaremos el método <code>ngOnInit()</code> vacío. Ahora la inicialización se delegará en un método dedicado a ello. Dicho método será llamado cada vez que se introduzca un email en el formulario.</p>
</div>
<div class="paragraph">
<p>Necesitaremos dos métodos:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Un método <code>buscarPersona()</code> que llamará al servicio de búsqueda de personas por email.</p>
</li>
<li>
<p>Un método <code>actualizarCamposPersona()</code> que será el que actualice el formulario con los datos recuperados por el método anterior. El método <code>actualizarCamposPersona()</code> será llamado cuando se introduzca un email en el formulario.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Hacemos una prueba llamando directamente a la API REST con Postman o con un navegador recuperando la persona a partir de su email para ver la estructura de datos de la respuesta. Al hacer la petición siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="code" class="language-code hljs">http://localhost:3000/personas?email=mtorres@ual.es</code></pre>
</div>
</div>
<div class="paragraph">
<p>obtenemos la respuesta siguiente:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">[
  {
    "email": "mtorres@ual.es",
    "nombre": "Manuel Torres Gil",
    "telefono": "84030",
    "unidad": "Departamento de Informática",
    "cargo": [
      "Profesor Titular de Universidad",
      "Director de Secretariado de Innovación Tecnológica"
    ],
    "docente": true
  }
]</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Vemos que la persona es un objeto que pertenece a un array.</strong></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { lastValueFrom, Observable, of, shareReplay } from 'rxjs';
import { PersonaService } from '../../../../services/persona.service';

@Component({
  selector: 'app-crear',
  templateUrl: './crear.component.html',
  styleUrls: ['./crear.component.css'],
})
export class CrearComponent implements OnInit {
  cargos: string[] = []; <i class="conum" data-value="1"></i><b>(1)</b>
  persona: any; <i class="conum" data-value="2"></i><b>(2)</b>

  formHorario: FormGroup = this.fb.group({
    nombre: [{ value: '', disabled: true }],
    cargo: [, [Validators.required]],
    unidad: [{ value: '', disabled: true }],
    telefono: [{ value: '', disabled: true }],
    email: [, [Validators.required, Validators.email]],
    tipo: [,],
    nombreActividad: [, [Validators.required, Validators.minLength(5)]],
    start: [,],
    end: [,],
    dia: [,],
    horaInicio: [,],
    horaFin: [,],
  });

  diasSemana: string[] = [
    'lunes',
    'martes',
    'miercoles',
    'jueves',
    'viernes',
    'sabado',
    'domingo',
  ];

  horas = Array.from(Array(24).keys());

  constructor(
    private fb: FormBuilder,
    private personaService: PersonaService <i class="conum" data-value="3"></i><b>(3)</b>
  ) {}

  ngOnInit(): void {} <i class="conum" data-value="4"></i><b>(4)</b>

  isNotValidField(field: string) {
    return (
      this.formHorario.controls[field].errors &amp;&amp;
      this.formHorario.controls[field].touched
    );
  }

  isValidForm() {
    return this.formHorario.valid;
  }

  buscarPersona(email: any) { <i class="conum" data-value="5"></i><b>(5)</b>
    this.personaService.findOne(email).subscribe((res) =&gt; { <i class="conum" data-value="6"></i><b>(6)</b>
      this.persona = res[0]; <i class="conum" data-value="7"></i><b>(7)</b>
    });
  }

  actualizarCamposPersona() { <i class="conum" data-value="8"></i><b>(8)</b>
    const email = this.formHorario.controls['email'].value; <i class="conum" data-value="9"></i><b>(9)</b>

    this.buscarPersona(email); <i class="conum" data-value="10"></i><b>(10)</b>

    if (this.persona) { <i class="conum" data-value="11"></i><b>(11)</b>
      this.cargos = [...this.persona.cargo];

      this.formHorario.controls['nombre'].setValue(this.persona.nombre);
      this.formHorario.controls['unidad'].setValue(this.persona.unidad);
      this.formHorario.controls['telefono'].setValue(this.persona.telefono);

      this.persona.cargo = this.formHorario.controls['cargo'].value;

      return;
    }
  }

  save() {
    console.log('this.formHorario :&gt;&gt; ', this.formHorario);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Variable para almacenar los cargos recuperados de una persona. Se usa para poblar el desplegable en el formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Variable para almacenar la persona recuperada del servicio</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inyección del servicio en el constructor</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Ahora ya no se inicializan los datos de la persona desde <code>ngOnInit</code></td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Método para la búsqueda de una persona mediante su email</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Llamada al servicio que recupera los datos de una persona</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Almacenamiento de los datos recuperados en la variable de instancia <code>persona</code>. <strong>Vimos que la persona está en la primera posición del array</strong></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Método de actualización de datos en el formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Acceso al valor del <code>email</code> introducido en el formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Llamada al método de búsqueda de personas por email</td>
</tr>
<tr>
<td><i class="conum" data-value="11"></i><b>11</b></td>
<td>Actualización de datos en el formulario si se recupera una persona</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ahora ya sólo falta llamar al método <code>actulizarCamposPersona()</code> desde el cuadro de texto del email.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxFlexAlign="center" fxLayoutAlign="center center"&gt;
  &lt;form [formGroup]="formHorario" autocomplete="off"&gt;
    &lt;h1&gt;Crear reserva&lt;/h1&gt;
    &lt;hr /&gt;
    &lt;div fxLayout="column wrap" fxLayoutGap="20px"&gt;
      &lt;mat-card&gt;
        &lt;mat-card-subtitle&gt;Datos personales&lt;/mat-card-subtitle&gt;
        &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
          &lt;div fxFlex&gt;
            &lt;mat-form-field appearance="outline" fxFill&gt;
              &lt;mat-label&gt;Email&lt;/mat-label&gt;
              &lt;input
                matInput
                formControlName="email"
                (blur)="actualizarCamposPersona()" <i class="conum" data-value="1"></i><b>(1)</b>
              /&gt;
              &lt;span
                class="invalid-mat-form-field"
                *ngIf="isNotValidField('email')"
                &gt;* Formato de email incorrecto&lt;/span
              &gt;
            &lt;/mat-form-field&gt;
          &lt;/div&gt;

...</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Llamada al método <code>actualizarCamposPersona()</code> tras perder el foco (evento  <code>blur</code>)</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/DatosPersonaDesdeServicio.png" alt="DatosPersonaDesdeServicio">
</div>
</div>
<div class="paragraph">
<p>Tras introducir un email registrado en el backend, se cargarán los datos de la persona. No obstante, vemos un comportamiento anómalo. Los datos no aparecen actualizados al retirar el foco de email por primera vez. Parece que hubiera que cambiar dos veces el foco, entrando y saliendo dos veces del email. Este comportamient anómalo se debe a que los datos de la persona están llegando tarde y no están al perder el foco la primera vez, pero sí parece que ya están disponibles si se vuelve a cambiar el foco.</p>
</div>
<div class="paragraph">
<p>A continuación veremos cómo solucionar este problema.</p>
</div>
<div class="sect3">
<h4 id="trueactualizaciones-con-datos-asíncronos"><a class="anchor" href="#trueactualizaciones-con-datos-asíncronos"></a>7.1. Actualizaciones con datos asíncronos.</h4>
<div class="paragraph">
<p>Para evitar el problema de que los datos que devuelve el servicio llegan con retraso y no están a tiempo para presentarlos en la pantalla esperaremos a que lleguen los datos antes de proceder a su presentación en pantalla.</p>
</div>
<div class="paragraph">
<p>El problema radica en que el método <code>buscarPersona()</code> actualizaba tarde los datos de la persona. El código siguiente ilustra los cambios que hacemos en el código</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">  buscarPersona(email: any) {
    /*
    this.personaService.findOne(email).subscribe((res) =&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
      this.persona = res[0];
    });
    */

    return lastValueFrom(this.personaService.findOne(email));<i class="conum" data-value="2"></i><b>(2)</b>
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Antigua llamada al servicio de búsqueda de persona por email</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Ahora <code>buscarPersona</code> devuelve una promesa de un observable, que se consumirá con <code>async/await</code>.</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">La función <code>lastValueFrom</code></div>
<div class="paragraph">
<p><code>lastValueFrom</code> es una función de <a href="https://rxjs.dev/">RxJS</a>, la librería que nos permite tratar las llamadas asíncronas mediante observables.</p>
</div>
<div class="paragraph">
<p><code>lastValueFrom</code> convierte un observable en una promesa mediante una suscripción al observable, esperando a que se complete y devolviendo el último valor del servicio llamado.</p>
</div>
<div class="paragraph">
<p>Posteriormente consumiremos el valor devuelto por <code>lastValueFrom</code> con <code>async/await</code>.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>También habrá que cambiar la llamada a <code>buscarPersona()</code> desde <code>actualizarDatosPersona()</code>. Quderá así:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">  async actualizarCamposPersona() { <i class="conum" data-value="1"></i><b>(1)</b>
    const email = this.formHorario.controls['email'].value;

    // this.buscarPersona(email); <i class="conum" data-value="2"></i><b>(2)</b>

    this.persona = (await this.buscarPersona(email))[0]; <i class="conum" data-value="3"></i><b>(3)</b>

    if (this.persona) {
      this.cargos = [...this.persona.cargo];

      this.formHorario.controls['nombre'].setValue(this.persona.nombre);
      this.formHorario.controls['unidad'].setValue(this.persona.unidad);
      this.formHorario.controls['telefono'].setValue(this.persona.telefono);

      this.persona.cargo = this.formHorario.controls['cargo'].value;

      return;
    }
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Ahora el método es async porque dentro contiene un <code>await</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Antigua forma de llamada a <code>buscarPersona()</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Carga de datos en persona</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Ahora, la carga de datos en persona no se realiza hasta que no se hayan recuperado sus datos del servicio.</p>
</div>
</div>
<div class="sect3">
<h4 id="truemejora-del-código-de-actualización-del-formulario-con-patchvalue"><a class="anchor" href="#truemejora-del-código-de-actualización-del-formulario-con-patchvalue"></a>7.2. Mejora del código de actualización del formulario con <code>patchValue</code></h4>
<div class="paragraph">
<p>En el código anterior teníamos un código engorroso que puede ser mejorado. Se trata de:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">      this.formHorario.controls['nombre'].setValue(this.persona.nombre);
      this.formHorario.controls['unidad'].setValue(this.persona.unidad);
      this.formHorario.controls['telefono'].setValue(this.persona.telefono);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Esto podría ser aún peor si en lugar de tener que actualizar 3 campos tuviésemos que actuliazar 10.</p>
</div>
<div class="paragraph">
<p>Para ello, cuando los nombres de los controles del formulario coincidan con los nombres usados en los objetos que contienen los datos (<code>nombre - nombre</code>, <code>unidad - unidad</code>, <code>telefono - telefono</code>) podemos usar <code>patchValue</code> que actualizará todos los valores que tengan el mismo nombre.</p>
</div>
<div class="paragraph">
<p>Así, el código anterior quedaría de la siguiente forma, mucho más limpio.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">  async actualizarCamposPersona() {
    const email = this.formHorario.controls['email'].value;

    this.buscarPersona(email);

    //this.persona = (await this.buscarPersona(email))[0];

    if (this.persona) {
      this.cargos = [...this.persona.cargo];

      this.formHorario.patchValue(this.persona); <i class="conum" data-value="1"></i><b>(1)</b>

      this.persona.cargo = this.formHorario.controls['cargo'].value;

      return;
    }

    this.clearPersonalData();
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>patchValue</code> hace la actualización de todos los datos en una sola línea</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="truelimpieza-de-datos-cuando-la-persona-no-existe"><a class="anchor" href="#truelimpieza-de-datos-cuando-la-persona-no-existe"></a>7.3. Limpieza de datos cuando la persona no existe</h4>
<div class="paragraph">
<p>Si probamos a introducir una persona que no existe, comprobaremos que no se actalizan los datos, lo que podría inducir a error. Si el formulario estaba vacío y se introduce un email inexistente, no se mostrarán datos. Pero, si ya había datos y se introduce un nuevo email, se mantendrán los datos de la persona anterior, lo que no es correcto.</p>
</div>
<div class="paragraph">
<p>La solución planteada consiste en crear un método que limpie el formulario si no se recuperan datos (<code>persona</code> no contiene datos). Para mejorar la experiencia de usuario usaremos el compoente Material Snackbar que muestra una barra al pie útil para mensajes.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>El módulo <code>SnackbarModule</code> que contiene al componente <code>MatSnackbar</code> es uno de los módulos que tenemos incluidos en nuestro módulo <code>Material</code>, lo que como está importado en el módulo del componente de solicitudes, permite usar todos los compomentes de nuetro módulo Material.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación se muestra el código completo de cómo quedaría el componente con el nuevo método de limpieza de datos con emails no existentes.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { lastValueFrom } from 'rxjs';
import { PersonaService } from '../../../../services/persona.service';
import { MatSnackBar } from '@angular/material/snack-bar'; <i class="conum" data-value="1"></i><b>(1)</b>

@Component({
  selector: 'app-crear',
  templateUrl: './crear.component.html',
  styleUrls: ['./crear.component.css'],
})
export class CrearComponent implements OnInit {
  cargos: string[] = [];

  persona: any;

  formHorario: FormGroup = this.fb.group({
    nombre: [{ value: '', disabled: true }],
    cargo: [, [Validators.required]],
    unidad: [{ value: '', disabled: true }],
    telefono: [{ value: '', disabled: true }],
    email: [, [Validators.required, Validators.email]],
    tipo: [,],
    nombreActividad: [, [Validators.required, Validators.minLength(5)]],
    start: [,],
    end: [,],
    dia: [,],
    horaInicio: [,],
    horaFin: [,],
  });

  diasSemana: string[] = [
    'lunes',
    'martes',
    'miercoles',
    'jueves',
    'viernes',
    'sabado',
    'domingo',
  ];

  horas = Array.from(Array(24).keys());

  constructor(
    private fb: FormBuilder,
    private personaService: PersonaService,
    private snackBar: MatSnackBar <i class="conum" data-value="2"></i><b>(2)</b>
  ) {}

  ngOnInit(): void {}

  isNotValidField(field: string) {
    return (
      this.formHorario.controls[field].errors &amp;&amp;
      this.formHorario.controls[field].touched
    );
  }

  isValidForm() {
    return this.formHorario.valid;
  }

  buscarPersona(email: any) {
    return lastValueFrom(this.personaService.findOne(email));
  }

  async actualizarCamposPersona() {
    const email = this.formHorario.controls['email'].value;

    this.persona = (await this.buscarPersona(email))[0];

    if (this.persona) {
      this.cargos = [...this.persona.cargo];

      this.formHorario.patchValue(this.persona);

      this.persona.cargo = this.formHorario.controls['cargo'].value;

      return;
    }

    this.clearPersonalData(); <i class="conum" data-value="3"></i><b>(3)</b>
  }

  clearPersonalData() { <i class="conum" data-value="4"></i><b>(4)</b>
    this.formHorario.reset(); <i class="conum" data-value="5"></i><b>(5)</b>

    this.snackBar.open('Persona no disponible', '', { <i class="conum" data-value="6"></i><b>(6)</b>
      duration: 1500,
    });
  }

  save() {
    console.log('this.formHorario :&gt;&gt; ', this.formHorario);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Importación del componente <code>MatSnackBar</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inyección del componente <code>MatSnakcBar</code> para poder usarlo más adelante.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Llamada al método de limpieza si <code>persona</code> no tiene datos</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Método de limpieza del formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Limpieza de los datos del formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Presentación del mensaje de error durante 1500 ms (1.5 segudos)</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación se muestra el mensaje el borrado de los datos del fomrulario y la presentación del mensaje de error en la barra tras introducir un email que no existe.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/PersonaNoDisponible.png" alt="PersonaNoDisponible">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueguardado-de-datos-en-backend"><a class="anchor" href="#trueguardado-de-datos-en-backend"></a>8. Guardado de datos en backend</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sección veremos cómo guardar los datos en el backend. Básicamente tendremos que</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Crear el servicio que se encargará del almacenamiento en el backend.</p>
</li>
<li>
<p>Actualizar el método <code>save()</code> para que llame al servicio de almacenamiento anterior.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="trueactualización-de-los-datos-de-json-server"><a class="anchor" href="#trueactualización-de-los-datos-de-json-server"></a>8.1. Actualización de los datos de JSON Server</h3>
<div class="paragraph">
<p>Vamos a contar con un nuevo elemento en nuestro backend de pruebas para las solicitudes. Para ello, basta con añadir el elemento siguiente a <code>db.json</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
  "personas": [
    {
      "email": "mtorres@ual.es",
      "nombre": "Manuel Torres Gil",
      "telefono": "84030",
      "unidad": "Departamento de Informática",
      "cargo": [
        "Profesor Titular de Universidad",
        "Director de Secretariado de Innovación Tecnológica"
      ],
      "docente": true
    },
    {
      "email": "ggf906@ual.es",
      "nombre": "Francisco José García García",
      "telefono": "N/D",
      "unidad": "STIC",
      "cargo": ["Gestor Informática"],
      "docente": false
    }
  ],
  "solicitudes": [] <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Nueva colección añadida</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Como tenemos iniciado JSON Server en modo <code>watch</code>, los cambios introducidos generan nuevos endpoints de forma inmediata en</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="code" class="language-code hljs">http://localhost:3000/solicitudes</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-del-servicio-de-almacenamiento"><a class="anchor" href="#truecreación-del-servicio-de-almacenamiento"></a>8.2. Creación del servicio de almacenamiento</h3>
<div class="paragraph">
<p>Comenzamos creando un nuevo servicio para las reservas</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g service services/solicitudes</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="truemodificación-de-las-variables-de-entorno"><a class="anchor" href="#truemodificación-de-las-variables-de-entorno"></a>8.3. Modificación de las variables de entorno</h3>
<div class="paragraph">
<p>Hasta ahora tenemos una URL desde donde recuperamos los datos de las personas. Este servicio realmente es ajeno al de la aplicación de espacios de este tutorial. Nuestra aplicación contará con servicios para gestión de solicitudes y consulta de espacios. Todos ellos los vamos a incluir en la misma URL y será diferentes de la URL de la API de personas que, como hemos comentado, es algo externo a esta aplicación de espacios. Por tanto, tendremos variables de entorno diferentes.</p>
</div>
<div class="paragraph">
<p>Archivo <code>environments/environments.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">export const environment = {
  production: false,
  urlPersonas: 'http://localhost:3000/personas',
  urlEspacios: 'http://localhost:3000',
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>La API de espacios tendrá endpoints como los siguientes. Todos ellos, tienen como elemento común <code>urlEspacios</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>GET <a href="http://localhost:3000/espacios/" class="bare">http://localhost:3000/espacios/</a></code></p>
</li>
<li>
<p><code>GET <a href="http://localhost:3000/solicitudes/" class="bare">http://localhost:3000/solicitudes/</a></code></p>
</li>
<li>
<p><code>GET <a href="http://localhost:3000/solicitudes/1" class="bare">http://localhost:3000/solicitudes/1</a></code></p>
</li>
<li>
<p><code>DELETE <a href="http://localhost:3000/espacios/1" class="bare">http://localhost:3000/espacios/1</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Archivo <code>environments/environments.prod.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">export const environment = {
  production: true,
  urlPersonas: 'http://&lt;your-production-people-api-server&gt;/personas',
  urlEspacios: 'http://&lt;your-production-espacios-api-server&gt;',
};</code></pre>
</div>
</div>
<div class="paragraph">
<p>Creación del método de almacenamiento en el servicio.</p>
</div>
<div class="paragraph">
<p>Archivo <code>services/reservations.service.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { environment } from './../../environments/environment';
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root',
})
export class ReservationsService {
  constructor(private http: HttpClient) {}

  save(data: any): Observable&lt;any&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
    return this.http.post(`${environment.urlEspacios}/reservations`, data);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Método que almacena los datos y devuelve un observable</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación modificaremos el método <code>save()</code> del componente de crear solicitudes para que llame al servicio anterior. Además, para ofrecer una mejor experiencia de usuario, mostraremos un mensaje en la <em>snackbar</em> indicando que se ha creado la solicitud y redirigiremos al usuario a la pantalla del listado de solicitudes. Allí podrá ver su solicitud, aunque aún no podrá ver nada ya que no está implementada. En la sección siguiente implementaremos la funcionalidad de mostrar el listado de solicitudes.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { lastValueFrom } from 'rxjs';
import { PersonaService } from '../../../../services/persona.service';
import { MatSnackBar } from '@angular/material/snack-bar';
import { SolicitudesService } from '../../../../services/solicitudes.service';
import { Router } from '@angular/router';

@Component({
  selector: 'app-crear',
  templateUrl: './crear.component.html',
  styleUrls: ['./crear.component.css'],
})
export class CrearComponent implements OnInit {
  cargos: string[] = [];

  persona: any;

  formHorario: FormGroup = this.fb.group({
    nombre: [{ value: '', disabled: true }],
    cargo: [, [Validators.required]],
    unidad: [{ value: '', disabled: true }],
    telefono: [{ value: '', disabled: true }],
    email: [, [Validators.required, Validators.email]],
    tipo: [,],
    nombreActividad: [, [Validators.required, Validators.minLength(5)]],
    start: [,],
    end: [,],
    dia: [,],
    horaInicio: [,],
    horaFin: [,],
  });

  diasSemana: string[] = [
    'lunes',
    'martes',
    'miercoles',
    'jueves',
    'viernes',
    'sabado',
    'domingo',
  ];

  horas = Array.from(Array(24).keys());

  constructor(
    private fb: FormBuilder,
    private personaService: PersonaService,
    private solicitudesService: SolicitudesService, <i class="conum" data-value="1"></i><b>(1)</b>
    private snackBar: MatSnackBar,
    private router: Router <i class="conum" data-value="2"></i><b>(2)</b>
  ) {}

  ngOnInit(): void {}

  isNotValidField(field: string) {
    return (
      this.formHorario.controls[field].errors &amp;&amp;
      this.formHorario.controls[field].touched
    );
  }

  isValidForm() {
    return this.formHorario.valid;
  }

  buscarPersona(email: any) {
    return lastValueFrom(this.personaService.findOne(email));
  }

  async actualizarCamposPersona() {
    const email = this.formHorario.controls['email'].value;

    this.persona = (await this.buscarPersona(email))[0];

    if (this.persona) {
      this.cargos = [...this.persona.cargo];

      this.formHorario.patchValue(this.persona);

      this.persona.cargo = this.formHorario.controls['cargo'].value;

      return;
    }

    this.clearPersonalData();
  }

  clearPersonalData() {
    this.formHorario.reset();

    this.snackBar.open('Persona no disponible', '', {
      duration: 1500,
    });
  }

  save() {
    let solicitud = this.formHorario.getRawValue(); <i class="conum" data-value="3"></i><b>(3)</b>

    this.solicitudesService.save(solicitud).subscribe((res) =&gt; { <i class="conum" data-value="4"></i><b>(4)</b>
      if (res) { <i class="conum" data-value="5"></i><b>(5)</b>
        this.snackBar.open('Solicitud creada', '', {  <i class="conum" data-value="6"></i><b>(6)</b>
          duration: 1500,
        });

        this.router.navigate(['/solicitudes/consultar']); <i class="conum" data-value="7"></i><b>(7)</b>
      }
    });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inyección del servicio de gestión de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inyección de <code>Router</code> para poder ir a la página del listado de solicitudes tras la creación de una solicitud</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inicializar un objeto <code>solicitud</code> con todos los valores introducidos en el formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Llamada al método <code>save</code> del servicio pasándole los datos de la solicitud a crear</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Comprobación de almacenamiento correcto</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Presentación de la <em>snackbar</em> con el mensaje de solicitud creada</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Redirigir a la página de listado de solicitudes</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelista-de-reservas"><a class="anchor" href="#truelista-de-reservas"></a>9. Lista de reservas</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sección crearemos la página que muestra las solicitudes creadas. Inicialmente las mostrará todas y después incorporaremos las posibilidad de filtrado para la consulta de solicitudes.</p>
</div>
<div class="sect2">
<h3 id="trueservicio-de-lista-de-reservas"><a class="anchor" href="#trueservicio-de-lista-de-reservas"></a>9.1. Servicio de lista de reservas</h3>
<div class="paragraph">
<p>Comenzaremos añadiendo al servicio <code>Solicitudes</code> un método que recupere todas las solicitudes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Observable } from 'rxjs';
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { environment } from 'src/environments/environment';

@Injectable({
  providedIn: 'root',
})
export class SolicitudesService {
  constructor(private http: HttpClient) {}

  findAll(): Observable&lt;any&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
    return this.http.get(`${environment.urlEspacios}/solicitudes`); <i class="conum" data-value="2"></i><b>(2)</b>
  }

  save(data: any): Observable&lt;any&gt; {
    return this.http.post(`${environment.urlEspacios}/solicitudes`, data);
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Método para recuperar las solicitudes. Devuelve un observable</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Llamada al método del servicio que recupera las solicitudes</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truecarga-de-datos-en-el-componente-de-listado-de-solicitudes"><a class="anchor" href="#truecarga-de-datos-en-el-componente-de-listado-de-solicitudes"></a>9.2. Carga de datos en el componente de listado de solicitudes</h3>
<div class="paragraph">
<p>Para la presentación de datos usaremos el componente <code>Table</code> de Angular Material, que ya tenemos incluido en nuestro módulo <code>Material</code>. Este componente tiene una parte TypeScript y una parte HTML. En la parte TypeScript básicamente debemos inicializar el conjunto de datos a mostrar y una lista de columnas a mostrar. Como peculiaridad, indicar que hay que cargar de forma independiente cada columna de datos. Veamos cómo hacerlo:</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/consultar/consultar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { SolicitudesService } from '../../../../services/solicitudes.service';

@Component({
  selector: 'app-consultar',
  templateUrl: './consultar.component.html',
  styleUrls: ['./consultar.component.css'],
})
export class ConsultarComponent implements OnInit {
  dataSource: any = [] <i class="conum" data-value="1"></i><b>(1)</b>
  displayedColumns= ['nombre', 'cargo', 'unidad', 'telefono']; <i class="conum" data-value="2"></i><b>(2)</b>

  constructor(
    private solicitudesService: SolicitudesService, <i class="conum" data-value="3"></i><b>(3)</b>
    private snackBar: MatSnackBar <i class="conum" data-value="4"></i><b>(4)</b>
  ) {}
  ngOnInit(): void { <i class="conum" data-value="5"></i><b>(5)</b>
    this.solicitudesService.findAll().subscribe((res) =&gt; { <i class="conum" data-value="6"></i><b>(6)</b>
      this.dataSource = res; <i class="conum" data-value="7"></i><b>(7)</b>
      if (this.dataSource.length == 0) { <i class="conum" data-value="8"></i><b>(8)</b>
        this.snackBar.open('No hay solicitudes', '', {
          duration: 1500,
        });
      }
    });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Variable para almacenar los datos recuperados por el servicio</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Variable para indicar las columnas a mostrar</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inyección del servicio de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Inyección de la snackbar para presentar mensajes al pie</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Inicializar la tabla al iniciar el componente</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Suscripción al método que recupera las solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Almacenar los datos recuperados del servicio</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Mostrar mensaje de error si no hay datos</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación vamos con la parte de la presentación de los datos (el código está copiado tal cual de la documentación)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column" fxLayoutAlign="center center"&gt;
  &lt;h1&gt;Listado de solicitudes&lt;/h1&gt;
  &lt;div *ngIf="dataSource.length &gt; 0"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;hr /&gt;
    &lt;mat-card&gt;
      &lt;table mat-table [dataSource]="dataSource" class="mat-elevation-z8"&gt; <i class="conum" data-value="2"></i><b>(2)</b>
        &lt;ng-container matColumnDef="nombre"&gt; <i class="conum" data-value="3"></i><b>(3)</b>
          &lt;th mat-header-cell *matHeaderCellDef&gt;Nombre&lt;/th&gt; <i class="conum" data-value="4"></i><b>(4)</b>
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.nombre }}&lt;/td&gt; <i class="conum" data-value="5"></i><b>(5)</b>
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="cargo"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Cargo&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.cargo }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="unidad"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Unidad&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.unidad }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="telefono"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Teléfono&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.telefono }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;tr mat-header-row *matHeaderRowDef="displayedColumns"&gt;&lt;/tr&gt; <i class="conum" data-value="6"></i><b>(6)</b>
        &lt;tr mat-row *matRowDef="let row; columns: displayedColumns"&gt;&lt;/tr&gt; <i class="conum" data-value="7"></i><b>(7)</b>
      &lt;/table&gt;
    &lt;/mat-card&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Presentación de la tabla si contiene datos</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inicialización de la tabla con su fuente de datos definida en la parte TS</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Definición de la columna del nombre</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Etiqueta que se quiere presentar en esta columna</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Indicar el campo del que se recuperarán los datos</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Crear la fila de cabecera</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Creación del cuerpo de la tabla</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación se muestra el listado de resultados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/ListarSolicitudes.png" alt="ListarSolicitudes">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truelista-de-espacios"><a class="anchor" href="#truelista-de-espacios"></a>10. Lista de espacios</h2>
<div class="sectionbody">
<div class="paragraph">
<p>De forma análoga a como acabamos de hacer con el listado de solicitudes vamos a implementar la parte del listado de solicitudes, que guarda bastante parecido con el anterior. Comenzaremos creando un listado completo y posteriormente le añadiremos capacidades de filtrado.</p>
</div>
<div class="sect2">
<h3 id="truegeneración-del-servicio"><a class="anchor" href="#truegeneración-del-servicio"></a>10.1. Generación del servicio</h3>
<div class="paragraph">
<p>En esta sección crearemos un servicio que recupere datos de persona. Comenzaremos creando un servicio.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g service services/espacios</code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuación añadiremos un método que recupere todos los espacios.</p>
</div>
<div class="paragraph">
<p>Método de recuperación de espacios en el servicio <code>services/espacios.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Observable } from 'rxjs';
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { environment } from 'src/environments/environment';

@Injectable({
  providedIn: 'root',
})
export class EspaciosService {
  constructor(private http: HttpClient) {} <i class="conum" data-value="1"></i><b>(1)</b>

  findAll(): Observable&lt;any&gt; { <i class="conum" data-value="2"></i><b>(2)</b>
    return this.http.get(`${environment.urlEspacios}/espacios`); <i class="conum" data-value="3"></i><b>(3)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inyección del cliente HTTP</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Método que devuelve los espacios como un observable</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Llamada al endpoint usando la variable de entorno</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>La variable de entorno se reutiliza. Sólo necesitamos la URL del servidor. El resto se añade en cada módulo funcional de la API.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Para que haya datos de prueba, añadiremos este nuevo elemento al archivo <code>db.json</code> de JSON Server para tener el endpoint de acceso a los espacios (<code><a href="http://localhost:3000/espacios" class="bare">http://localhost:3000/espacios</a></code>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
...
  "espacios": [
    {
      "edificio": "Aulario I",
      "aula": "Aula 2",
      "fecha": "07/02/2022",
      "reservas": [
        {
          "hora": "09:00 - 12:00",
          "descripcion": "GRUPO A",
          "asignatura": "( 12103230 ) - Lengua Clásica: Latín",
          "profesor": ""
        }
      ]
    },
    {
      "edificio": "Aulario I",
      "aula": "Aula 1",
      "fecha": "07/02/2022",
      "reservas": [
        {
          "hora": "09:00 - 12:00",
          "descripcion": "GRUPO UNICO",
          "asignatura": "( 67104216 ) - Gestión Integral de la Imagen",
          "profesor": ""
        }
      ]
    },
    {
      "edificio": "Aulario II",
      "aula": "Aula 1",
      "fecha": "07/02/2022",
      "reservas": [
        {
          "hora": "09:00 - 12:00",
          "descripcion": "GRUPO A",
          "asignatura": "( 31103209 ) - Lexicología y Semántica Inglesas",
          "profesor": ""
        },
        {
          "hora": "12:00 - 15:00",
          "descripcion": "GRUPO A",
          "asignatura": "( 12104226 ) - Historia de la Lengua Española II",
          "profesor": ""
        },
        {
          "hora": "16:00 - 19:00",
          "descripcion": "GRUPO UNICO",
          "asignatura": "( 40153329 ) - Teoría de Códigos y Criptografía",
          "profesor": ""
        }
      ]
    }
  ],
...
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueprogramación-del-componente"><a class="anchor" href="#trueprogramación-del-componente"></a>10.2. Programación del componente</h3>
<div class="paragraph">
<p>A continuación ya podemos programar el componente TypeScript de espacios <code>main/espacios/pages/consultar/consultar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { EspaciosService } from '../../../../services/espacios.service';

@Component({
  selector: 'app-consultar',
  templateUrl: './consultar.component.html',
  styleUrls: ['./consultar.component.css'],
})
export class ConsultarComponent implements OnInit {
  espacios: any = []; <i class="conum" data-value="1"></i><b>(1)</b>

  constructor(private espaciosService: EspaciosService) {} <i class="conum" data-value="2"></i><b>(2)</b>

  ngOnInit(): void { <i class="conum" data-value="3"></i><b>(3)</b>
    this.espaciosService.findAll().subscribe((res) =&gt; { <i class="conum" data-value="4"></i><b>(4)</b>
      this.espacios = res; <i class="conum" data-value="5"></i><b>(5)</b>
    });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Variable donde volcaremos los datos de los espacios</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inyección del servivio de espacios</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Método para recuperar los espacios. Devuelve un observable</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Llamada al método del servicio que recupera los espacios</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Carga de los datos leídos en la variable de espacios</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueconfiguración-de-las-importaciones-del-módulo"><a class="anchor" href="#trueconfiguración-de-las-importaciones-del-módulo"></a>10.3. Configuración de las importaciones del módulo</h3>
<div class="paragraph">
<p>A continuación se configurar las importaciones de <code>main/espacios/espacios.module.ts</code> para incluir nuestro módulo de <code>Material</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

import { EspaciosRoutingModule } from './espacios-routing.module';
import { ConsultarComponent } from './pages/consultar/consultar.component';
import { MaterialModule } from '../../material/material.module';

@NgModule({
  declarations: [ConsultarComponent],
  imports: [CommonModule, EspaciosRoutingModule, MaterialModule], <i class="conum" data-value="1"></i><b>(1)</b>
})
export class EspaciosModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Módulo de <code>Material</code></td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueprogramación-de-la-presentación-de-datos"><a class="anchor" href="#trueprogramación-de-la-presentación-de-datos"></a>10.4. Programación de la presentación de datos</h3>
<div class="paragraph">
<p>A continuación se muestra cómo presentamos los datos en el componente de espacios. Básicamente se trata de explotar la variable <code>espacios</code> que es la que contiene los datos. Para ello, se iterará sobre ella y se mostrarán los datos en tarjetas Material. Dentro de cada espacio, puede haber una lista de reservas. Por tanto, habrá que crear un bucle anidado que itere sobre las reservas de un espacio.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/pages/consultar/consultar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div
  *ngIf="espacios.length " <i class="conum" data-value="1"></i><b>(1)</b>
  fxLayout="column"
  fxLayoutAlign="center "
  fxLayoutGap="10px"
&gt;
  &lt;mat-card *ngFor="let espacio of espacios" class="mt-3" fxFill&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;mat-card-subtitle&gt;
      &lt;mat-label class="mat-body-strong"&gt;Edificio: &lt;/mat-label
      &gt;{{ espacio.edificio }} <i class="conum" data-value="3"></i><b>(3)</b>
      &lt;mat-label class="mat-body-strong"&gt;Aula: &lt;/mat-label&gt; {{ espacio.aula }}
      &lt;mat-label class="mat-body-strong"&gt;Fecha: &lt;/mat-label&gt;{{ espacio.fecha }}
    &lt;/mat-card-subtitle&gt;
    &lt;mat-list&gt;
      &lt;mat-list-item *ngFor="let reserva of espacio.reservas"&gt; <i class="conum" data-value="4"></i><b>(4)</b>
        &lt;mat-card-content&gt;
          &lt;mat-label class="mat-body-strong"&gt;Hora: &lt;/mat-label
          &gt;{{ reserva.hora }} <i class="conum" data-value="5"></i><b>(5)</b>
          &lt;mat-label class="mat-body-strong"&gt;Descripción: &lt;/mat-label
          &gt;{{ reserva.descripcion }}
          &lt;mat-label class="mat-body-strong"&gt;Asignatura: &lt;/mat-label
          &gt;{{ reserva.asignatura }}
          &lt;mat-label class="mat-body-strong"&gt;Profesor: &lt;/mat-label
          &gt;{{ reserva.profesor }}
        &lt;/mat-card-content&gt;
      &lt;/mat-list-item&gt;
    &lt;/mat-list&gt;
  &lt;/mat-card&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Impide que haya errores en el <code>*ngFor</code> siguiente cuando no hay datos</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Bucle para recorrer los espacios</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Presentación de datos de espacios</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Bucle anidado para recorrer las reservas de un espacio</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Presentación de los datos de una reserva</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueincorporación-de-funcionalidad-de-filtrado"><a class="anchor" href="#trueincorporación-de-funcionalidad-de-filtrado"></a>10.5. Incorporación de funcionalidad de filtrado</h3>
<div class="paragraph">
<p>En esta sección vamos a ver cómo llevar el código anterior del listado de solicitudes a un componente específico. Haremos esto porque vamos a estructurar la página de espacios en dos componentes. Uno para un componente de filtrado con cuadros de lista y de entrada de datos para especificar condiciones de filtrado. Otro para el componente de presentación de la tabla de datos.</p>
</div>
<div class="paragraph">
<p>Comencemos generando el componente de tabla de espacios para resultados de búsqueda y del formulario de búsqueda</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g component main/espacios/components/tabla-espacios
$ ng g component main/espacios/components/form-buscar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Es habitual colocar los componentes de un módulo funcional en una carpeta <code>components</code>, que está al mismo nivel que la carpeta <code>pages</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="trueflujo-de-datos-entre-los-componentes"><a class="anchor" href="#trueflujo-de-datos-entre-los-componentes"></a>10.5.1. Flujo de datos entre los componentes</h4>
<div class="paragraph">
<p>La organización y el flujo de datos entre componentes es el siguiente:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>La página de espacios incluye los selectores de sus componentes: en este caso el de filtrado y el de tabla de datos.</p>
</li>
<li>
<p>El objeto que contiene los datos de los espacios está en el componente de espacios, digamos el componente padre.</p>
</li>
<li>
<p>El componente padre pasa al componente hijo de tabla de datos los datos de los espacios. Lo hace como parámetro en el selector</p>
</li>
<li>
<p>El componente hijo de tabla de datos recibe en el TypeScript los datos de los espacios mediante un decorador <code>@Input()</code></p>
</li>
<li>
<p>El componente hijo de filtrado de datos pasa los datos al padre emitiendo eventos y adjuntando datos</p>
</li>
<li>
<p>El componente padre recibe los datos del componente hijo de filtrado escuchando el evento.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>La figura siguiente ilustra los componentes, el flujo y la parte relevante del código para conseguirlo.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/$$$$$$$$.png" alt="$$$$$$$$">
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueprogramación-de-la-parte-typescript-del-componente-de-tabla-de-datos"><a class="anchor" href="#trueprogramación-de-la-parte-typescript-del-componente-de-tabla-de-datos"></a>10.5.2. Programación de la parte TypeScript del componente de tabla de datos</h4>
<div class="paragraph">
<p>En esta parte sólo tendremos que añadir el decorador <code>@Input</code> y asociarle una variable, que será la que usen otros componentes para inyectarle datos.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/component/tabla-espacios/tabla-espacios.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, Input, OnInit } from '@angular/core';

@Component({
  selector: 'app-tabla-espacios', <i class="conum" data-value="1"></i><b>(1)</b>
  templateUrl: './tabla-espacios.component.html',
  styleUrls: ['./tabla-espacios.component.css'],
})
export class TablaEspaciosComponent implements OnInit {
  @Input() espacios: any; <i class="conum" data-value="2"></i><b>(2)</b>

  constructor() {}

  ngOnInit(): void {}
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Selector para usar este componente</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Decorador <code>Input()</code> que define una variable <code>espacios</code> en la que se recibirán los espacios</td>
</tr>
</table>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">El decorador <code>@Input</code></div>
<div class="paragraph">
<p>El decorador <code>@Input</code> ofrece un medio para inyectar datos a un componente desde otro componente externo. El componente de destino asociará a este decorador una variable en la que se recibirán los datos enviados desde otros componentes. El componente que envía los datos envía los datos mediante un atributo HTML. El atributo de envío coincide con la variable usada en el <code>@Input</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truerefactorización-en-un-componente-dedicado-a-la-tabla-de-datos"><a class="anchor" href="#truerefactorización-en-un-componente-dedicado-a-la-tabla-de-datos"></a>10.5.3. Refactorización en un componente dedicado a la tabla de datos</h4>
<div class="paragraph">
<p>Ahora llevaremos el código que creamos para el HTML del listado de espacios hasta el HTML de la tabla de datos, tal cual, respetando el uso de <code>espacios</code>.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/component/tabla-espacios/tabla-espacios.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div *ngIf="espacios.length"&gt;
  &lt;div fxLayout="column" fxLayoutAlign="center " fxLayoutGap="10px"&gt;
    &lt;mat-card *ngFor="let espacio of espacios" class="mt-3" fxFill&gt;
      &lt;mat-card-subtitle&gt;
        &lt;mat-label class="mat-body-strong"&gt;Edificio: &lt;/mat-label
        &gt;{{ espacio.edificio }}
        &lt;mat-label class="mat-body-strong"&gt;Aula: &lt;/mat-label&gt;
        {{ espacio.aula }} &lt;mat-label class="mat-body-strong"&gt;Fecha: &lt;/mat-label
        &gt;{{ espacio.fecha }}
      &lt;/mat-card-subtitle&gt;
      &lt;mat-list&gt;
        &lt;mat-list-item *ngFor="let reserva of espacio.reservas"&gt;
          &lt;mat-card-content&gt;
            &lt;mat-label class="mat-body-strong"&gt;Hora: &lt;/mat-label
            &gt;{{ reserva.hora }}
            &lt;mat-label class="mat-body-strong"&gt;Descripción: &lt;/mat-label
            &gt;{{ reserva.descripcion }}
            &lt;mat-label class="mat-body-strong"&gt;Asignatura: &lt;/mat-label
            &gt;{{ reserva.asignatura }}
            &lt;mat-label class="mat-body-strong"&gt;Profesor: &lt;/mat-label
            &gt;{{ reserva.profesor }}
          &lt;/mat-card-content&gt;
        &lt;/mat-list-item&gt;
      &lt;/mat-list&gt;
    &lt;/mat-card&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="trueconfiguración-de-la-página-de-listado-de-espacios"><a class="anchor" href="#trueconfiguración-de-la-página-de-listado-de-espacios"></a>10.5.4. Configuración de la página de listado de espacios</h4>
<div class="paragraph">
<p>Ahora la página de listado de espacios, que antes mostraba directamente el listado de espacios, se convertirá en una página que incluye al componente de formulario de búsqueda y al de filtrado de datos, tal y como se muestra a continuación.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20px"&gt;
  &lt;div fxFlex&gt;
    &lt;h1&gt;Lista de espacios&lt;/h1&gt;
    &lt;app-form-buscar &gt;&lt;/app-form-buscar&gt; <i class="conum" data-value="1"></i><b>(1)</b>
  &lt;/div&gt;
  &lt;div fxLayoutAlign="center stretch"&gt;
    &lt;app-tabla-espacios [espacios]="espacios"&gt;&lt;/app-tabla-espacios&gt; <i class="conum" data-value="2"></i><b>(2)</b>
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Selector para incluir el componente del formulario de búsqueda</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Selector para incluir el componente de tabla de datos y pasándole al decorador <code>@Input</code> definido como <code>espacios</code> el valor que tenemos almacenado en <code>espacios</code> de este componente, el componente padre.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Al pasar datos a un componente a través de <code>@Input</code>, la sintaxis</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;app-tabla-espacios [espacios]="espacios"&gt;&lt;/app-tabla-espacios&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>se interpreta así: la primera parte es el nombre del <code>Input</code> en el componente de destino; la segunda parte es el valor que le pasamos.</p>
</div>
<div class="paragraph">
<p>La página se verá así.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/ListaDeEspaciosSinFormularioDeBusqueda.png" alt="ListaDeEspaciosSinFormularioDeBusqueda">
</div>
</div>
<div class="paragraph">
<p>Vemos que aún no aparece el formulario para el filtrado. Lo crearemos en breve. Antes, hay que adaptar el módulo de estos componentes de espacios para incluir formularios reactivos</p>
</div>
</div>
<div class="sect3">
<h4 id="truemodificación-del-módulo-de-espacios"><a class="anchor" href="#truemodificación-del-módulo-de-espacios"></a>10.5.5. Modificación del módulo de espacios</h4>
<div class="paragraph">
<p>Hay que hace una modificación ligera al módulo de espacios para importar el módulo de formularios reactivos. Lo va a necesitar el componente del formulario de filtrado de espacios.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { ReactiveFormsModule } from '@angular/forms';
import { NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';

import { EspaciosRoutingModule } from './espacios-routing.module';
import { ConsultarComponent } from './pages/consultar/consultar.component';
import { MaterialModule } from '../../material/material.module';
import { TablaEspaciosComponent } from './components/tabla-espacios/tabla-espacios.component';
import { FormBuscarComponent } from './components/form-buscar/form-buscar.component';

@NgModule({
  declarations: [
    ConsultarComponent,
    TablaEspaciosComponent,
    FormBuscarComponent,
  ],
  imports: [
    CommonModule,
    EspaciosRoutingModule,
    MaterialModule,
    ReactiveFormsModule, <i class="conum" data-value="1"></i><b>(1)</b>
  ],
})
export class EspaciosModule {}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Incorporación del módulo de formularios reactivos</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="trueadaptación-del-servicio-de-búsqueda-para-que-acepte-parámetros-de-filtrado"><a class="anchor" href="#trueadaptación-del-servicio-de-búsqueda-para-que-acepte-parámetros-de-filtrado"></a>10.5.6. Adaptación del servicio de búsqueda para que acepte parámetros de filtrado</h4>
<div class="paragraph">
<p>En el servicio de espacios, el método <code>findAll()</code> devolvía todos los espacios y no ofrecía posibilidad de filtrado. A continuación se muestra una modificación para que permita como parámetros de filtrado los que le pueda pasar el formulario de filtrado.</p>
</div>
<div class="paragraph">
<p>El filtro de búsqueda llega como un objeto JSON clave-valor, donde la clave es el nombre del campo a filtrar y el valor, el valor de filtrado. La idea es ir concatenando uno detrás de otro los parámetros de filtrado como se muestra a continuación. Nótese que también se ordena para que aparezcan primero los espacios con las solicitudes ordenadas en el tiempo.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="code" class="language-code hljs">http://localhost:3002/espacios?_sort=fecha&amp;fecha=07/02/2022&amp;aula=Aula%201</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>En la URL anterior <code>%20</code> representa un espacio en blanco para consultar las solcitudes en <code>Aula 1</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Observable } from 'rxjs';
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { environment } from 'src/environments/environment';

@Injectable({
  providedIn: 'root',
})
export class EspaciosService {
  constructor(private http: HttpClient) {}

  findAll(filtroBusqueda: any): Observable&lt;any&gt; {
    let filtroRequest = ''; <i class="conum" data-value="1"></i><b>(1)</b>

    if (filtroBusqueda.start) { <i class="conum" data-value="2"></i><b>(2)</b>
      filtroRequest = filtroRequest.concat(`&amp;start=${filtroBusqueda.start}`);
    }

    if (filtroBusqueda.end) {
      filtroRequest = filtroRequest.concat(`&amp;end=${filtroBusqueda.end}`);
    }

    if (filtroBusqueda.horaInicio) {
      filtroRequest = filtroRequest.concat(
        `&amp;horaInicio=${filtroBusqueda.horaInicio}`
      );
    }
    if (filtroBusqueda.horaFin) {
      filtroRequest = filtroRequest.concat(
        `&amp;horaFin=${filtroBusqueda.horaFin}`
      );
    }
    if (filtroBusqueda.edificio) {
      filtroRequest = filtroRequest.concat(
        `&amp;edificio=${filtroBusqueda.edificio}`
      );
    }
    if (filtroBusqueda.aula) {
      filtroRequest = filtroRequest.concat(`&amp;aula=${filtroBusqueda.aula}`);
    }

    return this.http.get(
      `${environment.urlEspacios}/espacios?_sort=fecha${filtroRequest}`
    );
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="truecreación-de-un-formulario-inicial-de-búsqueda"><a class="anchor" href="#truecreación-de-un-formulario-inicial-de-búsqueda"></a>10.5.7. Creación de un formulario inicial de búsqueda</h4>
<div class="paragraph">
<p>Se trata de programar el formulario reactivo del componente de búsqueda, tanto en su parte TypeScript como en su parte HTML.</p>
</div>
<div class="paragraph">
<p>Comenzaremos con un formulario básico que aún no implementará la funcionalidad de búsqueda. Sí tendrá ya un método <code>buscar()</code>, pero su cuerpo aún estará vacío. Iremos construyendo el formulario de búsqueda de forma incremental.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/componentes/form-buscar/form-buscar.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup } from '@angular/forms';

@Component({
  selector: 'app-form-buscar',
  templateUrl: './form-buscar.component.html',
  styleUrls: ['./form-buscar.component.css'],
})
export class FormBuscarComponent implements OnInit {

  formBuscarEspacio: FormGroup = this.fb.group({ <i class="conum" data-value="1"></i><b>(1)</b>
    start: [,],
    end: [,],
    horaInicio: [,],
    horaFin: [,],
    edificio: [,],
    aula: [,],
    busqueda: [,],
  });

  hours = Array.from(Array(24).keys()); <i class="conum" data-value="2"></i><b>(2)</b>

  constructor(private fb: FormBuilder) {} <i class="conum" data-value="3"></i><b>(3)</b>

  ngOnInit(): void {}

  buscar() {} <i class="conum" data-value="4"></i><b>(4)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Componentes del formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Variable para almacenar las horas con las que poblar el desplegable de horas</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inyección de <code>FormBuilder</code></td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Declaración del método <code>buscar()</code> que implementaremos más adelante</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación crearemos la parte de presentación del formulario de búsqueda:</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/componentes/form-buscar/form-buscar.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;form [formGroup]="formBuscarEspacio"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
  &lt;mat-card&gt;
    &lt;mat-card-subtitle&gt;Datos para la consulta&lt;/mat-card-subtitle&gt;
    &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
      &lt;div fxFlex&gt;
        &lt;mat-form-field appearance="fill" fxFill&gt;
          &lt;mat-label&gt;Rango de fechas&lt;/mat-label&gt;
          &lt;mat-date-range-input [rangePicker]="picker"&gt;
            &lt;input
              matStartDate
              formControlName="start" <i class="conum" data-value="2"></i><b>(2)</b>
              placeholder="Start date"
            /&gt;
            &lt;input matEndDate formControlName="end" placeholder="End date" /&gt;
          &lt;/mat-date-range-input&gt;
          &lt;mat-datepicker-toggle
            matSuffix
            [for]="picker"
          &gt;&lt;/mat-datepicker-toggle&gt;
          &lt;mat-date-range-picker #picker&gt;&lt;/mat-date-range-picker&gt;
        &lt;/mat-form-field&gt;
      &lt;/div&gt;
      &lt;div fxFlex&gt;
        &lt;mat-form-field appearance="outline" fxFill&gt;
          &lt;mat-label&gt;Hora de inicio&lt;/mat-label&gt;
          &lt;mat-select formControlName="horaInicio"&gt; <i class="conum" data-value="3"></i><b>(3)</b>
            &lt;mat-option *ngFor="let hour of hours" value="{{ hour }}"&gt;{{
              hour
            }}&lt;/mat-option&gt;
          &lt;/mat-select&gt;
        &lt;/mat-form-field&gt;
      &lt;/div&gt;

      &lt;div fxFlex&gt;
        &lt;mat-form-field appearance="outline" fxFill&gt;
          &lt;mat-label&gt;Hora de fin&lt;/mat-label&gt;
          &lt;mat-select formControlName="horaFin"&gt; <i class="conum" data-value="4"></i><b>(4)</b>
            &lt;mat-option *ngFor="let hour of hours" value="{{ hour }}"&gt;{{
              hour
            }}&lt;/mat-option&gt;
          &lt;/mat-select&gt;
        &lt;/mat-form-field&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div fxLayout="row" fxLayoutGap="20px"&gt;
      &lt;div fxFlex&gt;
        &lt;mat-form-field appearance="outline" fxFill&gt;
          &lt;mat-label&gt;Edificio&lt;/mat-label&gt;
          &lt;mat-select formControlName="edificio"&gt; <i class="conum" data-value="5"></i><b>(5)</b>
            &lt;mat-option value="Aulario I"&gt;Aulario I&lt;/mat-option&gt;
            &lt;mat-option value="Aulario II"&gt;Aulario II&lt;/mat-option&gt;
          &lt;/mat-select&gt;
        &lt;/mat-form-field&gt;
      &lt;/div&gt;
      &lt;div fxFlex&gt;
        &lt;mat-form-field appearance="outline" fxFill&gt;
          &lt;mat-label&gt;Aula&lt;/mat-label&gt;
          &lt;mat-select formControlName="aula"&gt; <i class="conum" data-value="6"></i><b>(6)</b>
            &lt;mat-option value="Aula 1"&gt;Aula 1&lt;/mat-option&gt;
            &lt;mat-option value="Aula 2"&gt;Aula 2&lt;/mat-option&gt;
          &lt;/mat-select&gt;
        &lt;/mat-form-field&gt;
      &lt;/div&gt;
      &lt;div fxFlex&gt;
        &lt;mat-form-field appearance="outline" fxFill&gt;
          &lt;mat-label&gt;Texto de búsqueda&lt;/mat-label&gt;
          &lt;input matInput formControlName="busqueda" /&gt; <i class="conum" data-value="7"></i><b>(7)</b>
        &lt;/mat-form-field&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div fxLayout="row" fxLayoutAlign="center center"&gt;
      &lt;button
        mat-button
        mat-flat-button
        color="primary"
        type="submit"
        (click)="buscar()" <i class="conum" data-value="8"></i><b>(8)</b>
      &gt;
        Buscar
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/mat-card&gt;
&lt;/form&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Ligado del formulario al objeto formulario en la parte TypeScript</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Ligado del input en modo de formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Ligado del select en modo de formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Ligado del select en modo de formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Ligado del select en modo de formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Ligado del select en modo de formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Ligado del input en modo de formulario reactivo</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Ligado del input en modo de formulario reactivo</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Una vez creadas las partes TS y HTML del componente de formulario, sólo falta añadirlo como componente hijo al componente de consulta de espacios.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/pages/consultar/consultar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20px"&gt;
  &lt;div fxFlex&gt;
    &lt;h1&gt;Lista de espacios&lt;/h1&gt;
    &lt;app-form-buscar&gt;&lt;/app-form-buscar&gt;
  &lt;/div&gt;
  &lt;div fxLayoutAlign="center stretch"&gt;
    &lt;app-tabla-espacios [espacios]="espacios"&gt;&lt;/app-tabla-espacios&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Si ahora seleccionamos la página de consulta de espacios veremos que ya sí aparece el formulario. Nuestra página de consulta de espacios está formada por el componente de formulario y el de tabla de resultados. Sin embargo, si seleccionamos <code>Aulario II</code> y <code>Aula 1</code> como criterios de búsqueda y pulsamos <code>Buscar</code> vemos que no se filtran los resultados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/FormularioDeBusquedaQueNoBusca.png" alt="FormularioDeBusquedaQueNoBusca">
</div>
</div>
<div class="paragraph">
<p>Esto se debe a que aún no se están recuperando los parámetros de filtrado del formulario ni se están pasando al servicio de búsqueda para que devuelva un resultado filtrado. Lo veremos a continuación.</p>
</div>
</div>
<div class="sect3">
<h4 id="trueincorporación-de-capacidades-de-búsquedafiltrado"><a class="anchor" href="#trueincorporación-de-capacidades-de-búsquedafiltrado"></a>10.5.8. Incorporación de capacidades de búsqueda/filtrado</h4>
<div class="paragraph">
<p>Para finalizar con el formulario de búsqueda tenemos varias tareas pendientes:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Modificar el TS del componente hijo (el formulario de búsqueda) para implementar la función de configuración del filtro de búsqueda y para enviar los datos al componente padre (la página de consulta de espacios).</p>
</li>
<li>
<p>Implementar la función de búsqueda con parámetros en el componente padre (la página de espacios).</p>
</li>
<li>
<p>Recoger en la página de espacios los datos enviados desde el componente formulario.</p>
</li>
</ol>
</div>
<div class="sect4">
<h5 id="trueconfiguración-del-filtro-de-búsqueda-en-el-componente-hijo"><a class="anchor" href="#trueconfiguración-del-filtro-de-búsqueda-en-el-componente-hijo"></a>Configuración del filtro de búsqueda en el componente hijo</h5>
<div class="paragraph">
<p>Los componentes Angular envían sus datos a otros componentes (en este caso el formulario de búsqueda envía a la página de espacios) generando un evento personalizado a través del cual publica sus datos. Los datos que publicaremos serán los valores del filtro de búsqueda recogidos mediante el formulario. Veamos cómo hacerlo.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/components/form-buscar/form-buscar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, EventEmitter, OnInit, Output } from '@angular/core';
import { FormBuilder, FormGroup } from '@angular/forms';

@Component({
  selector: 'app-form-buscar',
  templateUrl: './form-buscar.component.html',
  styleUrls: ['./form-buscar.component.css'],
})
export class FormBuscarComponent implements OnInit {
  @Output() onSearchEspacio = new EventEmitter(); <i class="conum" data-value="1"></i><b>(1)</b>

  filtroBusqueda: any; <i class="conum" data-value="2"></i><b>(2)</b>

  formBuscarEspacio: FormGroup = this.fb.group({
    start: [,],
    end: [,],
    horaInicio: [,],
    horaFin: [,],
    edificio: [,],
    aula: [,],
    busqueda: [,],
  });

  hours = Array.from(Array(24).keys());

  constructor(private fb: FormBuilder) {}

  ngOnInit(): void {}

  buscar() {
    this.filtroBusqueda = { <i class="conum" data-value="3"></i><b>(3)</b>
      start: this.formBuscarEspacio.controls['start'].value,
      end: this.formBuscarEspacio.controls['end'].value,
      horaInicio: this.formBuscarEspacio.controls['horaInicio'].value,
      horaFin: this.formBuscarEspacio.controls['horaFin'].value,
      edificio: this.formBuscarEspacio.controls['edificio'].value,
      aula: this.formBuscarEspacio.controls['aula'].value,
    };
    this.onSearchEspacio.emit(this.filtroBusqueda); <i class="conum" data-value="4"></i><b>(4)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Creación de un evento personalizado para publicar los datos del filtro de búsqueda</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Objeto JSON donde almacenaremos las condiciones del filtro de búsqueda</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inicialización del filtro de búsqueda con los valores recogidos en el formulario.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Disparo del evento personalizado añadiéndole (publicando) los datos del filtro de búsqueda</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="trueimplementacion-de-la-función-de-búsqueda-con-parámetros-en-el-componente-padre"><a class="anchor" href="#trueimplementacion-de-la-función-de-búsqueda-con-parámetros-en-el-componente-padre"></a>Implementacion de la función de búsqueda con parámetros en el componente padre</h5>
<div class="paragraph">
<p>Se trata de incorporar al método <code>buscar()</code> los parámetros de búsqueda que serán utilizados en el método <code>findAll()</code> del servicio de espacios. También se usará una snackbar para mostrar posibles mensajes de error.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/pages/consultar/consultar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { EspaciosService } from '../../../../services/espacios.service';
import { MatSnackBar } from '@angular/material/snack-bar';

@Component({
  selector: 'app-consultar',
  templateUrl: './consultar.component.html',
  styleUrls: ['./consultar.component.css'],
})
export class ConsultarComponent implements OnInit {
  espacios: any = [];

  constructor(
    private espaciosService: EspaciosService,
    private snackBar: MatSnackBar <i class="conum" data-value="1"></i><b>(1)</b>
  ) {}

  ngOnInit(): void {} <i class="conum" data-value="2"></i><b>(2)</b>

  buscar(filtroBusqueda: any) {
    this.espacios = this.espaciosService
      .findAll(filtroBusqueda) <i class="conum" data-value="3"></i><b>(3)</b>
      .subscribe((res) =&gt; {
        this.espacios = res;

        if (this.espacios.length == 0) { <i class="conum" data-value="4"></i><b>(4)</b>
          this.snackBar.open('No hay datos', '', {
            duration: 1500,
          });
        }
      });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inyección de la snackbar</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>El método de inicialización ya no muestra todas los datos de espacios ocupados</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Llamada al método <code>findAll()</code> del servicio pasándole el filtro de búsqueda</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Presentación de mensaje de error si no hay datos</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="truerecogida-de-datos-en-el-componente-padre"><a class="anchor" href="#truerecogida-de-datos-en-el-componente-padre"></a>Recogida de datos en el componente padre</h5>
<div class="paragraph">
<p>Aquí se trata de escuchar al evento que va a publicar el componente del formulario de búsqueda y disparar una acción, que consisitirá en la llamada al método de búsqueda.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/espacios/pages/consultar/consultar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column" fxLayoutAlign="center center" fxLayoutGap="20px"&gt;
  &lt;div fxFlex&gt;
    &lt;h1&gt;Lista de reservas&lt;/h1&gt;
    &lt;app-form-buscar (onSearchEspacio)="buscar($event)"&gt;&lt;/app-form-buscar&gt; <i class="conum" data-value="1"></i><b>(1)</b>
  &lt;/div&gt;
  &lt;div fxLayoutAlign="center stretch"&gt;
    &lt;app-tabla-espacios [espacios]="espacios"&gt;&lt;/app-tabla-espacios&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Llamar al método <code>buscar()</code> tras la publicación del evento <code>onSearchEspacio</code> pasándole los datos recibidos en el evento <code>$event</code>.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>La utilización de un evento publicado por parte de otro componente se hace siguiendo este patrón:</p>
</div>
<div class="paragraph">
<p>Llamar a un método como respuesta al evento publicado y pasándole al método como parámetro los datos recibidos a través de un objeto <code>$event</code>).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;app-form-buscar (onSearchEspacio)="buscar($event)"&gt;&lt;/app-form-buscar&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>El código anterior escucha a un evento <code>onSearchEspacio</code> publicado por el componente <code>app-form-buscar</code>. En respuesta, llama a un método <code>buscar()</code> pasándole a través de <code>$event</code> los datos publicados/enviados por el evento.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Si ahora volvemos a seleccionar <code>Aulario II</code> y <code>Aula 1</code> como criterios de búsqueda y pulsamos Buscar vemos que ya sí se filtran los resultados.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/EspaciosFiltrados.png" alt="EspaciosFiltrados">
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Flujo datos entre componentes</div>
<div class="paragraph">
<p>Envío del evento, recepción del evento, acción y envío de datos&#8230;&#8203;</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="truecuadros-de-diálogo"><a class="anchor" href="#truecuadros-de-diálogo"></a>11. Cuadros de diálogo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Un aspecto útil que debemos controlar es la presentación de información en cuadros de diálogo. Veamos en esta sección cómo tratar con ellos.</p>
</div>
<div class="sect2">
<h3 id="truecuadro-de-diálogo-informativo"><a class="anchor" href="#truecuadro-de-diálogo-informativo"></a>11.1. Cuadro de diálogo informativo</h3>
<div class="paragraph">
<p>Comenzaremos creando un cuadro de diálogo informativo, que son los más sencillos. Se trata de un cuadro de diálogo con información del proyecto. Se abrirá al pulsar un botón <code>Créditos</code> que vamos a añadir a la barra lateral.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Para usar cuadros de diálogo es necesario el módulo Material <code>MatDialogModule</code>. Nuestro módulo <code>Material</code> ya lo tenía incorporado. Si no disponemos de un modo tan genérico como nuestro <code>Material</code> que puede ser demasiado en algunos casos, <code>MatDialogModule</code> tiene que estar en el módulo en el que está el componente desde el que se va a abrir el cuadro de diálogo.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Comenzaremos creando el componente para el cuadro de diálogo. Como es algo informativo y común a toda la aplicación no lo incluiremos en la carpeta <code>main</code>. Lo colocaremos en <code>shared/sidebar/components</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g component shared/sidebar/components/dialogoCreditos</code></pre>
</div>
</div>
<div class="paragraph">
<p>A continuación vamos a implementar la lógica del cuadro de diálogo (p.e. qué hacer al aceptar). Para ello, implementaremos un método que denominaremos <code>aceptar()</code> a modo de prueba. Necesitaremos trabajar un objetp <code>MatDialogRef</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>De acuerdo con la documentación de Angular Material, al abrir un cuadro de diálogo, éste devolverá una instancia de <code>MatDialogRef. Este `MatDialogRef</code> proporciona un `
<em>handle</em> sobre el cuadro de diálogo abierto. Aquí lo usaremos para cerrar el cuadro de diálogo.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Archivo <code>shared/sidebar/components/dialogo-creditos/dialogo-creditos.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { MatDialogRef } from '@angular/material/dialog';

@Component({
  selector: 'app-dialogo-creditos',
  templateUrl: './dialogo-creditos.component.html',
  styleUrls: ['./dialogo-creditos.component.css'],
})
export class DialogoCreditosComponent implements OnInit {
  constructor(public dialogRef: MatDialogRef&lt;DialogoCreditosComponent&gt;) {} <i class="conum" data-value="1"></i><b>(1)</b>

  ngOnInit(): void {}

  aceptar() { <i class="conum" data-value="2"></i><b>(2)</b>
    console.log('Pulsaste Aceptar'); <i class="conum" data-value="3"></i><b>(3)</b>
    this.dialogRef.close(); <i class="conum" data-value="4"></i><b>(4)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inyección del <em>handle</em> para manejar el cuadro de diálogo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Método al que llamar cuando se pulse el botón <code>Aceptar</code> del cuadro de diálogo</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Mostrar un eco en la consola para saber que el método se ejecutó.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Cerrar el cuadro de diálogo.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación crearemos el contenido del cuadro de diálogo (p.e. información del proyecto). Usaremos las directivas de estilo para los cuadros de diálogo de Material (p.e. <code>mat-dialog-title, mat-dialog-content, mat-dialog-actions</code> y el estilo <code>mat-typography</code>.</p>
</div>
<div class="paragraph">
<p>Archivo <code>shared/sidebar/components/dialogo-creditos/dialogo-creditos.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;h1 mat-dialog-title&gt;Créditos&lt;/h1&gt;
&lt;div mat-dialog-content class="mat-typography"&gt;
  &lt;h3&gt;Dirección del proyecto&lt;/h3&gt;
  &lt;p&gt;
    Culpa incididunt ut occaecat amet dolore eiusmod ex ut sit laborum in
    nostrud.
  &lt;/p&gt;

  &lt;h3&gt;Equipo de desarrollo&lt;/h3&gt;
  &lt;p&gt;
    Laboris excepteur voluptate deserunt labore ex consequat nisi fugiat non
    incididunt adipisicing nisi ipsum labore.
  &lt;/p&gt;

  &lt;h3&gt;Información del proyecto&lt;/h3&gt;
  &lt;p&gt;
    &lt;a href="https://www.ual.es" target="_blank"&gt;Web del proyecto&lt;/a&gt;
  &lt;/p&gt;
&lt;/div&gt;
&lt;div mat-dialog-actions&gt;
  &lt;button mat-button [mat-dialog-close] cdkFocusInitial&gt;Cancelar&lt;/button&gt; <i class="conum" data-value="1"></i><b>(1)</b>
  &lt;button mat-button mat-flat-button color="primary" (click)="aceptar()"&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    Aceptar
  &lt;/button&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Botón <code>Cerrar</code> al que asociaremos directamente la directiva de cierre del formulario</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Botón <code>Aceptar</code> que llamará al método que hemos creado un poco más arriba.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A continuación, añadiremos a la barra lateral la lógica que abrirá el cuadro de diálogo</p>
</div>
<div class="paragraph">
<p>Archivo <code>shared/sidebar/sidebar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { MatDialog } from '@angular/material/dialog';
import { DialogoCreditosComponent } from './components/dialogo-creditos/dialogo-creditos.component';

@Component({
  selector: 'app-sidebar',
  templateUrl: './sidebar.component.html',
  styleUrls: ['./sidebar.component.css'],
})
export class SidebarComponent implements OnInit {
  constructor(public dialog: MatDialog) {} <i class="conum" data-value="1"></i><b>(1)</b>

  ngOnInit(): void {}

  creditos() { <i class="conum" data-value="2"></i><b>(2)</b>
    const dialogRef = this.dialog.open(DialogoCreditosComponent, { <i class="conum" data-value="3"></i><b>(3)</b>
      width: '50%',
    });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inyección del objeto <code>MatDialog</code> para poder abrirlo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Método que será llamado para abrir el cuadro de diálogo</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Abrir el cuadro de diálogo y que ocupe el 50% del ancho de la pantalla</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Por último, ya sólo falta añadir a la barra lateral el botón que abre el cuadro de diálogo y asociarle el método <code>creditos()</code> que acabamos de crear.</p>
</div>
<div class="paragraph">
<p>Archivo <code>shared/sidebar/sidebar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column"&gt;
  &lt;button mat-button routerLink="/"&gt;Home&lt;/button&gt;
  &lt;hr /&gt;

  &lt;mat-accordion&gt;
    ...
  &lt;/mat-accordion&gt;
  &lt;button mat-button (click)="creditos()"&gt;Créditos&lt;/button&gt; <i class="conum" data-value="1"></i><b>(1)</b>
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Botón que abre el cuadro de diálogo</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/DialogoInformativo.png" alt="DialogoInformativo">
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="trueeliminación-de-solicitudes"><a class="anchor" href="#trueeliminación-de-solicitudes"></a>12. Eliminación de solicitudes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>En esta sección vamoa ver cómo podemos realizar eliminaciones en nuestra aplicación. Para ello, dado que en la sección anterior hemos visto cómo presentar un cuadro de diálogo, nos apoyaremos en esa técnica para mostrar en un cuadro de diálogo informativo los datos que se van a eliminar antes de proceder a su eliminación.</p>
</div>
<div class="paragraph">
<p>La forma de proceder para la eliminación de solicitudes es incluir en el listado de solicitudes un botón de eliminar al lado de cada solicitud. El botón llamará a un método de eliminación al que pasaremos todos los datos de la solicitud que se vaya a eliminar. Con esos datos se podrá completar un cuadro de diálogo que permitirá la confirmación o la cancelación de la eliminación.</p>
</div>
<div class="sect2">
<h3 id="truecreación-del-cuadro-de-diálogo-de-confirmación-de-eliminación"><a class="anchor" href="#truecreación-del-cuadro-de-diálogo-de-confirmación-de-eliminación"></a>12.1. Creación del cuadro de diálogo de confirmación de eliminación.</h3>
<div class="paragraph">
<p>Comencemos creando el componente del cuadro de diálogo de eliminación. Se trata de un componente que estará dentro de la carpeta de solicitudes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">$ ng g component main/solicitudes/components/dialogoEliminar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Usaremos los módulos <code>MatIconModule, MatDialogModule</code>, que ya están incorporados en nuestro módulo <code>Material</code></p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truecreación-del-método-de-eliminación-de-solicitudes"><a class="anchor" href="#truecreación-del-método-de-eliminación-de-solicitudes"></a>12.2. Creación del método de eliminación de solicitudes</h3>
<div class="paragraph">
<p>A continuación debemos implementar en el servicio <code>Solicitudes</code> el método de eliminación de solicitudes añadiéndolo a <code>services/reservations.service.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { environment } from './../../environments/environment';
import { Observable } from 'rxjs';
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root',
})
export class SolicitudesService {
  constructor(private http: HttpClient) {}

  findAll(): Observable&lt;any&gt; {
    return this.http.get(`${environment.urlEspacios}/solicitudes`);
  }

  save(data: any): Observable&lt;any&gt; {
    return this.http.post(`${environment.urlEspacios}/solicitudes`, data);
  }

  delete(id: any): Observable&lt;any&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
    return this.http.delete(`${environment.urlEspacios}/solicitudes/${id}`); <i class="conum" data-value="2"></i><b>(2)</b>
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Método de eliminación de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Llamada al método HTTP de eliminación componiendo la URL</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="trueprogramación-de-la-lógica-del-cuadro-de-diálogo-de-eliminación"><a class="anchor" href="#trueprogramación-de-la-lógica-del-cuadro-de-diálogo-de-eliminación"></a>12.3. Programación de la lógica del cuadro de diálogo de eliminación</h3>
<div class="paragraph">
<p>EL cuadro de diálogo de eliminación usará un <em>handle</em> para manejar (en nuestro caso cerrar) el cuadro de diálogo y se le inyectarán los datos que queremos mostrar (en nuestro caso los datos de la solicitud a eliminar).</p>
</div>
<div class="paragraph">
<p>También usará el servicio de reservas para proceder a la eliminación, una snackbar para la presentación de mensajes y un router para redirigir la aplicación a otra pantalla tras la eliminación.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/components/dialogo-eliminar/dialogo-eliminar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, Inject, OnInit } from '@angular/core';
import { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';
import { Router } from '@angular/router';
import { ReservationsService } from '../../../../services/reservations.service';
import { MatSnackBar } from '@angular/material/snack-bar';

@Component({
  selector: 'app-dialogo-eliminar',
  templateUrl: './dialogo-eliminar.component.html',
  styleUrls: ['./dialogo-eliminar.component.css'],
})
export class DialogoEliminarComponent implements OnInit {
  constructor(
    public dialogRef: MatDialogRef&lt;DialogoEliminarComponent&gt;, <i class="conum" data-value="1"></i><b>(1)</b>
    @Inject(MAT_DIALOG_DATA) public data: any, <i class="conum" data-value="2"></i><b>(2)</b>
    private reservationsService: ReservationsService, <i class="conum" data-value="3"></i><b>(3)</b>
    private router: Router, <i class="conum" data-value="4"></i><b>(4)</b>
    private snackBar: MatSnackBar <i class="conum" data-value="5"></i><b>(5)</b>
  ) {}

  ngOnInit(): void {}

  eliminar() { <i class="conum" data-value="6"></i><b>(6)</b>
    this.reservationsService.delete(this.data.id).subscribe(() =&gt; { <i class="conum" data-value="7"></i><b>(7)</b>
      this.snackBar.open('Solicitud eliminada', '', { <i class="conum" data-value="8"></i><b>(8)</b>
        duration: 1500,
      });

      this.dialogRef.close(); <i class="conum" data-value="9"></i><b>(9)</b>
      this.router.navigate([this.router.url]).then(() =&gt; { <i class="conum" data-value="10"></i><b>(10)</b>
        window.location.reload();
      });
    });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Inyección del <em>handle</em> para manejar el cuadro de diálogo</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Inyección de datos para el cuadro de diálogo</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Servicio de operaciones solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Router para desviar la aplicación a otra página tras la eliminación</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Snackbar para la presentación de mensajes</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Método para eliminación de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Llamada al método eliminación del servicio</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Presentación de la snackbar</td>
</tr>
<tr>
<td><i class="conum" data-value="9"></i><b>9</b></td>
<td>Cierre del cuadro de diálogo</td>
</tr>
<tr>
<td><i class="conum" data-value="10"></i><b>10</b></td>
<td>Recargar la ruta de la página</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truepresentación-de-los-datos-en-el-cuadro-de-diálogo-de-eliminación"><a class="anchor" href="#truepresentación-de-los-datos-en-el-cuadro-de-diálogo-de-eliminación"></a>12.4. Presentación de los datos en el cuadro de diálogo de eliminación</h3>
<div class="paragraph">
<p>La parte TypeScript del cuadro de diálogo tiene en una variable <code>data</code> los datos que se van a eliminar. Los mostraremos en el cuadro de diálogo para que los usuarios pueden comprobar lo que van a eliminar antes de proceder.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/components/dialogo-eliminar/dialogo-eliminar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;h1 mat-dialog-title&gt;Confirmación de eliminación&lt;/h1&gt;
&lt;div mat-dialog-content class="mat-typography"&gt;
  &lt;h3&gt;Desea eliminar esto?&lt;/h3&gt;
  &lt;p&gt;Reserva para : {{ data.nombre }} - {{ data.cargo }}&lt;/p&gt; <i class="conum" data-value="1"></i><b>(1)</b>
  &lt;p&gt;Actividad: {{ data.nombreActividad }}&lt;/p&gt;
  &lt;p&gt;
    Desde {{ data.start | date: "dd/MM/yyyy" }} hasta
    {{ data.end | date: "dd/MM/yyyy" }}. Día: {{ data.dia }}. Hora:
    {{ data.horaInicio }} - {{ data.horaFin }}
  &lt;/p&gt;
&lt;/div&gt;
&lt;div mat-dialog-actions&gt;
  &lt;button mat-button [mat-dialog-close] cdkFocusInitial&gt;Cancelar&lt;/button&gt; <i class="conum" data-value="2"></i><b>(2)</b>
  &lt;button mat-button mat-flat-button color="warn" (click)="eliminar()"&gt; <i class="conum" data-value="3"></i><b>(3)</b>
    Eliminar
  &lt;/button&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Presentación de elementos <code>nombre</code> y <code>cargo</code> del objeto <code>data</code></td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Acción de cierre del cuadro proporionada por <code>[mat-dialog-close]</code></td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Llamada al método <code>eliminar()</code> implmementado en la parte TypeScript del cuadro de diálogo</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Programación de la llamada a la eliminación desde el listado de solicitudes.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/consultar/consultar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { SolicitudesService } from '../../../../services/solicitudes.service';
import { MatSnackBar } from '@angular/material/snack-bar';
import { MatDialog } from '@angular/material/dialog';
import { DialogoEliminarComponent } from '../../components/dialogo-eliminar/dialogo-eliminar.component';

@Component({
  selector: 'app-consultar',
  templateUrl: './consultar.component.html',
  styleUrls: ['./consultar.component.css'],
})
export class ConsultarComponent implements OnInit {
  solicitudes: any = [];

  dataSource: any = [];
  displayedColumns = ['nombre', 'cargo', 'unidad', 'telefono', 'acciones'];

  constructor(
    private solicitudesService: SolicitudesService, <i class="conum" data-value="1"></i><b>(1)</b>
    private snackBar: MatSnackBar, <i class="conum" data-value="2"></i><b>(2)</b>
    public dialog: MatDialog <i class="conum" data-value="3"></i><b>(3)</b>
  ) {}
  ngOnInit(): void {
    this.solicitudesService.findAll().subscribe((res) =&gt; { <i class="conum" data-value="4"></i><b>(4)</b>
      this.dataSource = res;
      if (this.dataSource.length == 0) { <i class="conum" data-value="5"></i><b>(5)</b>
        this.snackBar.open('No hay solicitudes', '', {
          duration: 1500,
        });
      }
    });
  }

  eliminar(element: any) { <i class="conum" data-value="6"></i><b>(6)</b>
    this.dialog.open(DialogoEliminarComponent, { <i class="conum" data-value="7"></i><b>(7)</b>
      data: element, <i class="conum" data-value="8"></i><b>(8)</b>
    });
  }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Servicio en el que está el método de eliminación de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Snackbar para la presentación de mensajes de error</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Inyección del cuadro de diálogo para poder abrirlo</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Recuperación de la lista de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Presentación de mensaje de error en la snakbar si no hay solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Método <code>eliminar()</code> llamado desde la página del listado de solicitudes</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Abrir el cuadro de diálogo pasándole datos en <code>data</code></td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Configurar <code>data</code> con los datos que reciba el método</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="truepresentación-del-botón-de-eliminación-en-el-listado-de-solicitudes"><a class="anchor" href="#truepresentación-del-botón-de-eliminación-en-el-listado-de-solicitudes"></a>12.5. Presentación del botón de eliminación en el listado de solicitudes</h3>
<div class="paragraph">
<p>Por último, ya sólo nos falta incluir un botón de eliminar en el componente  del listado de solicitudes y que llame al método que presenta el cuadro de diálogo de eliminación pasándole los datos de la solicitud a eliminar.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/consultar/consultar.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column" fxLayoutAlign="center center"&gt;
  &lt;h1&gt;Listado de solicitudes&lt;/h1&gt;
  &lt;div *ngIf="dataSource.length &gt; 0"&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;hr /&gt;
    &lt;mat-card&gt;
      &lt;table mat-table [dataSource]="dataSource" class="mat-elevation-z8"&gt;
        &lt;ng-container matColumnDef="nombre"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Nombre&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.nombre }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="cargo"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Cargo&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.cargo }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="unidad"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Unidad&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.unidad }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="telefono"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Teléfono&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.telefono }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;!-- Get Details --&gt;
        &lt;ng-container matColumnDef="acciones"&gt;  <i class="conum" data-value="2"></i><b>(2)</b>
          &lt;th mat-header-cell *matHeaderCellDef&gt;Acciones&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt; <i class="conum" data-value="3"></i><b>(3)</b>
            &lt;button
              mat-stroked-button
              color="primary"
              (click)="eliminar(element)" <i class="conum" data-value="4"></i><b>(4)</b>
            &gt;
              &lt;mat-icon&gt;delete&lt;/mat-icon&gt; <i class="conum" data-value="5"></i><b>(5)</b>
              Eliminar
            &lt;/button&gt;
          &lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;tr mat-header-row *matHeaderRowDef="displayedColumns"&gt;&lt;/tr&gt;
        &lt;tr mat-row *matRowDef="let row; columns: displayedColumns"&gt;&lt;/tr&gt;
      &lt;/table&gt;
    &lt;/mat-card&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Mostrar la tabla si hay datos</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Bloque para la columna de acciones</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Configuración del valor de la celda a todo el registro mostrado (<code>element</code>)</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Llamada al método <code>eliminar()</code> de la parte TypeScript pasándole todo el registro</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Incorporación del icono de la papelera al botón</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Veamos el resultado en funcionamiento. Partimos de una pantalla con un conjunto de solicitudes. Al lado de cada solicitud aparecerá un botón para poder eliminarla.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/PantallaParaEliminarSolicitudes.png" alt="PantallaParaEliminarSolicitudes">
</div>
</div>
<div class="paragraph">
<p>Si pulsamos <code>Eliminar</code> sobre una de ellas aparecerá el cuadro de diálogo de confirmación mostrando los datos para comprobar que es la solicitud a eliminar.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/ConfirmarEliminarSolicitud.png" alt="ConfirmarEliminarSolicitud">
</div>
</div>
<div class="paragraph">
<p>Si confirmamos la eliminación, se eliminará la solicitud, se informará en una snackbar y se devolverá la aplicación para que vuelva a mostrar la lista de solicitudes. La solicitud eliminada ya no aparecerá.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/SolicitudesTrasEliminar.png" alt="SolicitudesTrasEliminar">
</div>
</div>
</div>
<div class="sect2">
<h3 id="trueactualización-de-solicitudes"><a class="anchor" href="#trueactualización-de-solicitudes"></a>12.6. Actualización de solicitudes</h3>
<div class="paragraph">
<p>Implementación de los métodos <code>findOne</code> para búsqueda de la solicitud a modificar y <code>update</code> para actualización con los nuevos datos.</p>
</div>
<div class="paragraph">
<p>Archivo <code>services/reservations.service.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { environment } from './../../environments/environment';
import { HttpClient } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root',
})
export class ReservationsService {
  constructor(private http: HttpClient) {}

  findOne(id: any): Observable&lt;any&gt; { <i class="conum" data-value="1"></i><b>(1)</b>
    return this.http.get(`${environment.urlEspacios}/reservations/${id}`); <i class="conum" data-value="2"></i><b>(2)</b>
  }

  findAll(): Observable&lt;any&gt; {
    return this.http.get(`${environment.urlEspacios}/reservations`);
  }

  save(data: any): Observable&lt;any&gt; {
    return this.http.post(`${environment.urlEspacios}/reservations`, data);
  }

  delete(id: any): Observable&lt;any&gt; {
    return this.http.delete(`${environment.urlEspacios}/reservations/${id}`);
  }

  update(data: any): Observable&lt;any&gt; { <i class="conum" data-value="3"></i><b>(3)</b>
    return this.http.put( <i class="conum" data-value="4"></i><b>(4)</b>
      `${environment.urlEspacios}/reservations/${data.id}`,
      data
    );
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>La ruta de editar será nueva, pero la gestionará el mismo componente de Crear solicitud. Habrá que adaptarlo, pero básicamente es lo mismo pero con <code>id</code>  y tendrá que llamar a un método <code>PATCH</code> en lugar de uno <code>POST</code>. Lo veremos más adelante.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/solictudes.routing.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { NgModule } from '@angular/core';
import { RouterModule, Routes } from '@angular/router';
import { CrearComponent } from './pages/crear/crear.component';
import { ConsultarComponent } from './pages/consultar/consultar.component';

const routes: Routes = [
  {
    path: '',
    children: [
      { path: 'crear', component: CrearComponent },
      { path: 'editar/:id', component: CrearComponent }, <i class="conum" data-value="1"></i><b>(1)</b>
      { path: 'consultar', component: ConsultarComponent },
    ],
  },
  {
    path: '**',
    redirectTo: 'crear',
  },
];

@NgModule({
  imports: [RouterModule.forChild(routes)],
  exports: [RouterModule],
})
export class SolicitudesRoutingModule {}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Adaptación del componente de Crear solicitud para que también valga para editar.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { FormBuilder, FormGroup, Validators } from '@angular/forms';
import { PeopleService } from '../../../../services/people.service';
import { ReservationsService } from '../../../../services/reservations.service';
import { MatSnackBar } from '@angular/material/snack-bar';
import { ActivatedRoute, Router } from '@angular/router';

@Component({
  selector: 'app-crear',
  templateUrl: './crear.component.html',
  styleUrls: ['./crear.component.css'],
})
export class CrearComponent implements OnInit {
  editMode: boolean = false;
  id: any;

  formHorario: FormGroup = this.fb.group({
    nombre: [{ value: '', disabled: true }],
    cargo: [, [Validators.required]],
    unidad: [{ value: '', disabled: true }],
    telefono: [{ value: '', disabled: true }],
    email: [, [Validators.required, Validators.email]],
    tipo: [,],
    nombreActividad: [, [Validators.required, Validators.minLength(5)]],
    start: [,],
    end: [,],
    dia: [,],
    horaInicio: [,],
    horaFin: [,],
  });

  daysOfWeek: string[] = [
    'lunes',
    'martes',
    'miercoles',
    'jueves',
    'viernes',
    'sabado',
    'domingo',
  ];

  hours = Array.from(Array(24).keys());
  people: any = [];
  cargos: any = [];

  constructor(
    private fb: FormBuilder,
    private peopleService: PeopleService,
    private reservationsService: ReservationsService,
    private snackBar: MatSnackBar,
    private router: Router,
    private route: ActivatedRoute <i class="conum" data-value="1"></i><b>(1)</b>
  ) {}

  ngOnInit(): void {
    this.editMode = false; <i class="conum" data-value="2"></i><b>(2)</b>
    this.id = this.route.snapshot.params['id']; <i class="conum" data-value="3"></i><b>(3)</b>
    if (this.id) { <i class="conum" data-value="4"></i><b>(4)</b>
      this.reservationsService.findOne(this.id).subscribe((res) =&gt; { <i class="conum" data-value="5"></i><b>(5)</b>
        this.editMode = true; <i class="conum" data-value="6"></i><b>(6)</b>
        this.formHorario.patchValue({ ...res }); <i class="conum" data-value="7"></i><b>(7)</b>
      });
    }
  }

  isValidField(field: string) {
    return (
      this.formHorario.controls[field].errors &amp;&amp;
      this.formHorario.controls[field].touched
    );
  }

  isValidForm() {
    return this.formHorario.valid;
  }

  findPeople(email: any) {
    this.peopleService.findOne(email).subscribe((res) =&gt; {
      this.people = res;
    });
  }

  updatePeopleFields() {
    const email = this.formHorario.controls['email'].value;
    this.findPeople(email);

    if (this.people.length &gt; 0) {
      this.cargos = [...this.people[0].cargo];

      this.formHorario.controls['nombre'].setValue(this.people[0].nombre);
      this.formHorario.controls['unidad'].setValue(this.people[0].unidad);
      this.formHorario.controls['telefono'].setValue(this.people[0].telefono);

      this.people.cargo = this.formHorario.controls['cargo'].value;

      return;
    }
    this.clearPersonalData();
  }

  clearPersonalData() {
    this.formHorario.controls['nombre'].setValue('');
    this.formHorario.controls['unidad'].setValue('');
    this.formHorario.controls['telefono'].setValue('');
    this.formHorario.controls['cargo'].setValue('');
  }

  save() {
    let {
      nombre,
      cargo,
      unidad,
      telefono,
      email,
      tipo,
      nombreActividad,
      start,
      end,
      dia,
      horaInicio,
      horaFin,
    } = this.formHorario.controls;

    let reservation: any = {
      nombre: nombre.value,
      cargo: cargo.value,
      unidad: unidad.value,
      telefono: telefono.value,
      email: email.value,
      tipo: tipo.value,
      nombreActividad: nombreActividad.value,
      start: start.value,
      end: end.value,
      dia: dia.value,
      horaInicio: horaInicio.value,
      horaFin: horaFin.value,
    };

    if (this.editMode) { <i class="conum" data-value="8"></i><b>(8)</b>
      (reservation.id = this.id), <i class="conum" data-value="9"></i><b>(9)</b>
        this.reservationsService.update(reservation).subscribe(() =&gt; { <i class="conum" data-value="10"></i><b>(10)</b>
          this.snackBar.open('Solicitud actualizada', '', {
            duration: 1500,
          });

          this.router.navigate(['/solicitudes/consultar']);

        });
    } else {
      this.reservationsService.save(reservation).subscribe((res) =&gt; { <i class="conum" data-value="11"></i><b>(11)</b>
        this.snackBar.open('Solicitud guardada', '', {
          duration: 1500,
        });

        this.router.navigate(['/solicitudes/consultar']);
      });
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;1&gt;
&lt;2&gt;
&lt;3&gt;
&lt;4&gt;
&lt;5&gt;
&lt;6&gt;
&lt;7&gt;
&lt;8&gt;
&lt;9&gt;
&lt;10&gt;
&lt;11&gt;</p>
</div>
<div class="paragraph">
<p>Modificación de la presentación del formulario de Crear solicitud para que sirva también para actualizar. Básicamente se trata de cambiar el título de la página y el del botón. El método al que se llama para guardar sigue siendo el mismo y será el que se encargue de saber si tiene que actualizar o insertar en función del valor de <code>editMode</code>, que básicamente se terminaba a partir de lo que indicase la ruta.</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/solicitudes/pages/crear/crear.component.html</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxFlexAlign="center" fxLayoutAlign="center center"&gt;
  &lt;form [formGroup]="formHorario" autocomplete="off"&gt;
    &lt;h1&gt;{{ editMode ? "Editar" : "Crear" }} reserva&lt;/h1&gt; <i class="conum" data-value="1"></i><b>(1)</b>
    &lt;hr /&gt;

....

        &lt;div fxLayout="row" fxLayoutAlign="end"&gt;
          &lt;button
            mat-stroked-button
            color="primary"
            (click)="save()"
            [disabled]="!isValidForm()"
          &gt;
            {{ editMode ? "Actualizar" : "Crear" }} <i class="conum" data-value="2"></i><b>(2)</b>
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/mat-card&gt;
    &lt;/div&gt;
  &lt;/form&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;1&gt;
&lt;2&gt;</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">La seguridad ha de estar en el backend</div>
<div class="paragraph">
<p>Para que filtre si alguien está intentando modificar una reserva que no le corresponda &#8230;&#8203;.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Programación de la llamada a la actualización en el listado solicitudes</p>
</div>
<div class="paragraph">
<p>Archivo <code>main/pages/solicitudes/consultar/consultar.component.ts</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="ts" class="language-ts hljs">import { Component, OnInit } from '@angular/core';
import { MatDialog } from '@angular/material/dialog';
import { Router } from '@angular/router'; <i class="conum" data-value="1"></i><b>(1)</b>
import { ReservationsService } from '../../../../services/reservations.service';
import { DialogoEliminarComponent } from '../../components/dialogo-eliminar/dialogo-eliminar.component';

@Component({
  selector: 'app-consultar',
  templateUrl: './consultar.component.html',
  styleUrls: ['./consultar.component.css'],
})
export class ConsultarComponent implements OnInit {
  reservations: any = [];
  columns: any;
  dataSource: any;
  displayedColumns: any;

  constructor(
    private reservationsService: ReservationsService,
    public dialog: MatDialog,
    private router: Router <i class="conum" data-value="2"></i><b>(2)</b>
  ) {}

  ngOnInit(): void {
    this.reservationsService.findAll().subscribe((res) =&gt; {
      this.reservations = res;
      this.displayData();
    });
  }

  displayData() {
    this.dataSource = this.reservations;
    this.displayedColumns = [
      'nombre',
      'cargo',
      'unidad',
      'telefono',
      'acciones',
    ];
  }

  editar(element: any) { <i class="conum" data-value="3"></i><b>(3)</b>
    this.router.navigate([`/solicitudes/editar/${element.id}`]); <i class="conum" data-value="4"></i><b>(4)</b>
  }

  eliminar(element: any) {
    const dialogRef = this.dialog.open(DialogoEliminarComponent, {
      data: element,
    });
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;1&gt;
&lt;2&gt;
&lt;3&gt;
&lt;4&gt;</p>
</div>
<div class="paragraph">
<p>Creación del botón de Actualización de solicitudes en la pantalla de Consultar solicitudes para iniciar el proceso de actualización.</p>
</div>
<div class="paragraph">
<p>Archivo `main</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="html" class="language-html hljs">&lt;div fxLayout="column" fxFlexAlign="center" fxLayoutAlign="center center"&gt;
  &lt;h1&gt;Listado de solicitudes&lt;/h1&gt;
  &lt;div&gt;
    &lt;hr /&gt;
    &lt;mat-card *ngIf="reservations.length &gt; 0"&gt;
      &lt;table mat-table [dataSource]="dataSource" class="mat-elevation-z8"&gt;
        &lt;ng-container matColumnDef="nombre"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Nombre&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.nombre }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="cargo"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Cargo&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.cargo }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="unidad"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Unidad&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.unidad }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;ng-container matColumnDef="telefono"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Teléfono&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;{{ element.telefono }}&lt;/td&gt;
        &lt;/ng-container&gt;

        &lt;!-- Botones de acción --&gt;
        &lt;ng-container matColumnDef="acciones"&gt;
          &lt;th mat-header-cell *matHeaderCellDef&gt;Acciones&lt;/th&gt;
          &lt;td mat-cell *matCellDef="let element"&gt;
            &lt;button <i class="conum" data-value="1"></i><b>(1)</b>
              mat-stroked-button
              color="primary"
              (click)="editar(element)" <i class="conum" data-value="2"></i><b>(2)</b>
            &gt;
              &lt;mat-icon&gt;edit&lt;/mat-icon&gt;
              Editar
            &lt;/button&gt;
            &lt;button
              mat-stroked-button
              color="primary"
              (click)="eliminar(element)"
            &gt;
              &lt;mat-icon&gt;delete&lt;/mat-icon&gt;
              Eliminar
            &lt;/button&gt;
          &lt;/td&gt;
        &lt;/ng-container&gt;
        &lt;tr mat-header-row *matHeaderRowDef="displayedColumns"&gt;&lt;/tr&gt;
        &lt;tr mat-row *matRowDef="let row; columns: displayedColumns"&gt;&lt;/tr&gt;
      &lt;/table&gt;
    &lt;/mat-card&gt;
  &lt;/div&gt;
&lt;/div&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>&lt;1&gt;
&lt;2&gt;</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-03-04 21:16:44 +0100
</div>
</div>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/github.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
<script>hljs.initHighlighting()</script>
</body>
</html>